# 前端页面交互设计文档

## 一、整体布局设计

### 1.1 布局方式
- **布局组件**: 采用Element Plus的Container布局组件
- **导航结构**: 顶部导航栏 + 侧边栏菜单 + 主内容区
- **响应式设计**: 支持桌面端和移动端适配
- **主题风格**: 使用Element Plus默认主题，支持暗色模式（可选）

### 1.2 断点设置
- **桌面端**: ≥1200px（完整布局）
- **平板端**: 768px-1199px（侧边栏可折叠）
- **移动端**: <768px（侧边栏抽屉式）

### 1.3 移动端适配
- 表格使用卡片式布局替代
- 对话框全屏显示
- 按钮组垂直排列

## 二、页面路由设计

### 2.1 路由结构
```
/ (重定向到 /login)
├── /login - 登录页面
├── /register - 注册页面
└── /dashboard - 主面板（需要登录）
    ├── /dashboard/proxy-services - 代理服务列表（默认）
    ├── /dashboard/proxy-services/create - 创建代理服务
    ├── /dashboard/proxy-services/:id - 代理服务详情
    ├── /dashboard/system - 系统配置
    └── /dashboard/profile - 个人中心
```

### 2.2 路由守卫
- 未登录用户访问 `/dashboard/*` 时重定向到 `/login`
- 已登录用户访问 `/login` 或 `/register` 时重定向到 `/dashboard`

## 三、登录页面 (/login)

### 3.1 功能要求
- 用户名/密码输入框
- 登录按钮
- 注册链接（如果注册功能开启）
- 记住我选项
- 错误提示显示

### 3.2 交互流程
1. 用户输入用户名和密码
2. 点击登录按钮，显示加载状态
3. 登录成功：跳转到 `/dashboard`
4. 登录失败：显示错误提示（用户名或密码错误）
5. 如果注册功能关闭，隐藏注册链接

### 3.3 UI组件
- `el-form` + `el-form-item`
- `el-input` (type="text" 和 type="password")
- `el-button` (type="primary")
- `el-checkbox` (记住我)
- `el-alert` (错误提示)

### 3.4 页面布局
- 居中卡片式布局
- 卡片宽度：400px
- 标题："代理服务管理系统"

## 四、注册页面 (/register)

### 4.1 功能要求
- 用户名输入（唯一性校验）
- 密码输入（强度提示）
- 确认密码输入（一致性校验）
- 注册按钮
- 返回登录链接

### 4.2 交互流程
1. 用户输入用户名，实时校验是否已存在
2. 输入密码，显示强度提示（弱/中/强）
3. 输入确认密码，实时校验是否一致
4. 点击注册按钮，显示加载状态
5. 注册成功：显示成功提示，2秒后跳转到登录页
6. 注册失败：显示错误提示（用户名已存在等）

### 4.3 UI组件
- `el-form` + 表单验证规则
- `el-input` (带验证)
- `el-button`
- `el-alert` (成功/错误提示)
- 密码强度指示器（自定义组件）

### 4.4 安全提示
- 注册时显示安全提示："您的密码将使用MD5加密存储"

### 4.5 验证规则
- 用户名：必填，3-20字符，只能包含字母、数字、下划线
- 密码：必填，至少6位
- 确认密码：必填，必须与密码一致

## 五、主面板布局 (/dashboard)

### 5.1 布局结构
```
┌─────────────────────────────────────┐
│  顶部导航栏 (Logo + 用户信息 + 退出)  │
├──────────┬──────────────────────────┤
│          │                          │
│ 侧边栏    │      主内容区              │
│ 菜单      │                          │
│          │                          │
│ - 代理服务 │                          │
│ - 系统配置 │                          │
│ - 个人中心 │                          │
└──────────┴──────────────────────────┘
```

### 5.2 顶部导航栏
- **左侧**: Logo/标题 "代理服务管理系统"
- **右侧**: 
  - 当前用户名
  - 下拉菜单（个人中心、退出登录）

### 5.3 侧边栏菜单
- 使用 `el-menu` 组件
- 菜单项：
  - 代理服务（默认选中）
  - 系统配置
  - 个人中心
- 支持折叠/展开
- 当前路由高亮显示

### 5.4 主内容区
- 使用 `el-main` 组件
- 路由视图容器
- 内边距：20px

## 六、代理服务列表页面 (/dashboard/proxy-services)

### 6.1 功能要求
- 代理服务列表表格
- 创建代理服务按钮
- 每个代理服务的操作：查看详情、编辑Host配置、查看日志、启动/停止、删除

### 6.2 表格列设计
| 列名 | 说明 | 宽度 |
|------|------|------|
| 名称 | 代理服务名称 | 150px |
| 跳板服务器 | 跳板服务器地址 (host:port) | 180px |
| 代理端口 | SOCKS代理端口 | 100px |
| Host数量 | 配置的域名数量 | 100px |
| 状态 | 运行中/已停止/错误 | 100px |
| 创建时间 | 创建时间 | 150px |
| 操作 | 操作按钮组 | 200px |

### 6.3 状态显示
- **运行中**: 绿色标签 `el-tag type="success"`
- **已停止**: 灰色标签 `el-tag type="info"`
- **错误**: 红色标签 `el-tag type="danger"`

### 6.4 交互流程
1. 页面加载时获取代理服务列表
2. 点击"创建代理服务"按钮 → 跳转到创建页面
3. 点击"查看详情" → 显示详情对话框
4. 点击"编辑Host" → 打开Host配置对话框
5. 点击"查看日志" → 打开日志查看对话框
6. 点击"启动/停止" → 显示确认对话框，执行操作
7. 点击"删除" → 显示确认对话框，删除前检查是否有运行的进程

### 6.5 空状态
- 如果没有代理服务，显示空状态提示和"创建第一个代理服务"按钮
- 使用 `el-empty` 组件

### 6.6 操作按钮组
- 查看详情：`el-button type="text" size="small"`
- 编辑Host：`el-button type="text" size="small"`
- 查看日志：`el-button type="text" size="small"`
- 启动/停止：`el-button type="text" size="small"`
- 删除：`el-button type="text" size="small" danger`

## 七、创建代理服务页面 (/dashboard/proxy-services/create)

### 7.1 功能要求
- 代理服务名称输入
- 跳板服务器信息输入（host、port、username、password）
- 显示代理端口（自动分配，只读显示）
- 配置Host列表（支持添加/删除）
- 提供默认Host列表一键导入
- 创建按钮

### 7.2 表单设计

#### 7.2.1 代理服务名称
- `el-input` 文本输入
- 用于标识代理服务，方便管理
- 验证：必填，1-50字符

#### 7.2.2 跳板服务器配置区域
- **主机地址**: `el-input` (必填，IP或域名)
- **端口**: `el-input type="number"` (默认22，必填)
- **用户名**: `el-input` (必填，SSH用户名)
- **密码**: `el-input type="password"` (必填，用于推送公钥)
- **安全提示**: 使用 `el-alert` 显示"您的密码仅用于将SSH公钥推送到跳板服务器，不会保存"
- **确认复选框**: 添加"我已了解"确认复选框

#### 7.2.3 代理端口显示
- `el-input` (readonly)
- 显示：自动分配的端口号（从1080-1082中选择未使用的）

#### 7.2.4 Host配置区域
- 使用 `el-tag` + `el-input` 组合
- 支持添加多个Host
- 每个Host显示为标签，可删除
- 输入框支持回车添加
- Host格式验证（域名格式）

#### 7.2.5 默认Host列表
- 折叠面板 `el-collapse`
- 显示常用网站列表（google.com, youtube.com, facebook.com, twitter.com, instagram.com等）
- "一键导入"按钮，将默认Host添加到配置中

### 7.3 交互流程
1. 页面加载时获取可用端口
2. 填写代理服务名称
3. 填写跳板服务器信息（host、port、username）
4. 输入密码并勾选"我已了解"确认
5. 添加Host（手动输入或一键导入）
6. 点击"创建"按钮
7. 显示加载状态（后端生成SSH密钥、推送公钥、创建代理服务）
8. 创建成功：显示成功提示，跳转到代理服务列表
9. 创建失败：显示错误提示（连接失败、认证失败等）

### 7.4 验证规则
- 代理服务名称：必填，1-50字符
- 跳板服务器host：必填，IP或域名格式
- 跳板服务器port：必填，1-65535
- 跳板服务器username：必填
- 跳板服务器password：必填，且需勾选"我已了解"
- Host列表：至少一个Host
- Host格式：域名格式验证

### 7.5 错误处理
- **SSH连接失败**: 显示"无法连接到跳板服务器，请检查网络和地址"
- **认证失败**: 显示"用户名或密码错误"
- **公钥推送失败**: 显示"公钥推送失败，请重试"
- **端口已占用**: 显示"代理端口已被占用，请重试"

### 7.6 安全设计（重点）
- 密码输入框使用 `el-input type="password"`
- 显示安全提示："您的密码仅用于将SSH公钥推送到跳板服务器，不会保存"
- 使用 `el-alert type="info"` 显示安全说明
- 密码输入区域使用特殊样式突出显示
- 添加"我已了解"确认复选框（必选）

## 八、代理服务详情对话框

### 8.1 功能要求
- 显示代理服务基本信息（名称、跳板服务器信息、代理端口）
- 显示当前状态
- 显示配置的Host列表
- 快速操作按钮（启动/停止/编辑Host）

### 8.2 内容设计
- 使用 `el-dialog` 组件
- 信息展示使用 `el-descriptions` 组件
- 跳板服务器信息：host:port (username)
- 操作按钮组在底部

### 8.3 信息展示
- **基本信息**: 名称、创建时间
- **跳板服务器**: 主机地址、端口、用户名
- **代理配置**: 代理端口、状态
- **Host列表**: 以标签形式展示

## 九、Host配置对话框

### 9.1 功能要求
- 显示当前代理服务的Host列表
- 支持添加新Host
- 支持删除Host
- 显示Host冲突提示（如果该Host已被其他代理服务使用）
- 保存按钮

### 9.2 交互流程
1. 打开对话框，加载当前Host列表
2. 添加Host：输入域名，实时校验格式和冲突
3. 删除Host：点击删除按钮，显示确认提示
4. 点击保存：显示加载状态，保存配置
5. 保存成功：关闭对话框，刷新列表
6. 保存失败：显示错误提示

### 9.3 冲突提示
- 如果Host已被其他代理服务使用，显示红色警告："该Host已被代理服务XXX使用"
- 使用 `el-alert type="warning"` 显示

### 9.4 UI组件
- `el-dialog`
- `el-tag` (Host标签)
- `el-input` (添加Host输入框)
- `el-button` (保存按钮)

## 十、日志查看对话框

### 10.1 功能要求
- 显示代理服务的运行日志
- 支持实时刷新
- 支持清空日志
- 日志自动滚动到底部

### 10.2 UI设计
- 使用 `el-dialog` + `el-scrollbar`
- 日志内容使用等宽字体显示
- 时间戳 + 日志级别 + 日志内容
- 自动滚动开关
- 刷新按钮

### 10.3 日志格式
```
[2024-01-01 12:00:00] [INFO] 代理服务启动成功
[2024-01-01 12:00:01] [INFO] 连接到跳板服务器 192.168.1.1:22
[2024-01-01 12:00:02] [ERROR] 连接失败，正在重试...
```

### 10.4 交互功能
- **自动滚动**: 开关控制是否自动滚动到底部
- **刷新**: 手动刷新日志内容
- **清空**: 清空当前显示的日志（不影响后端日志文件）

## 十一、系统配置页面 (/dashboard/system)

### 11.1 功能要求
- 注册功能开关
- 显示当前系统配置
- 保存按钮

### 11.2 UI设计
- 使用 `el-form` 布局
- 注册功能开关：`el-switch` 组件
- 显示开关说明："开启后，用户可以自行注册账号"
- 保存按钮：`el-button type="primary"`

### 11.3 交互流程
1. 页面加载时获取系统配置
2. 切换注册功能开关
3. 点击"保存"按钮
4. 显示加载状态
5. 保存成功：显示成功提示
6. 保存失败：显示错误提示

### 11.4 配置项
- **注册功能**: 开关（默认开启）
- **管理端口**: 只读显示（从配置中读取）

## 十二、个人中心页面 (/dashboard/profile)

### 12.1 功能要求
- 显示当前用户信息
- 修改密码功能
- 退出登录按钮

### 12.2 用户信息展示
- 用户名（只读）
- 注册时间（只读）

### 12.3 修改密码表单
- 当前密码输入
- 新密码输入
- 确认新密码输入
- 修改按钮

### 12.4 交互流程
1. 输入当前密码和新密码
2. 点击"修改"按钮
3. 显示加载状态
4. 修改成功：显示成功提示，清空表单
5. 修改失败：显示错误提示（当前密码错误等）

### 12.5 验证规则
- 当前密码：必填
- 新密码：必填，至少6位
- 确认新密码：必填，必须与新密码一致

### 12.6 退出登录
- 退出按钮：`el-button type="danger"`
- 点击后显示确认对话框
- 确认后清除Session，跳转到登录页

## 十三、通用交互组件

### 13.1 加载状态
- 使用 `el-loading` 指令
- 按钮加载状态：`el-button :loading="true"`
- 页面加载：全屏loading遮罩

### 13.2 消息提示
- **成功**: `this.$message.success('操作成功')`
- **错误**: `this.$message.error('操作失败')`
- **警告**: `this.$message.warning('警告信息')`
- **信息**: `this.$message.info('提示信息')`

### 13.3 确认对话框
- 使用 `el-message-box.confirm`
- 危险操作（删除、停止）使用 `type="warning"`
- 普通确认使用 `type="info"`

### 13.4 表单验证
- 使用 Element Plus 的表单验证规则
- 实时验证和提交前验证
- 错误提示显示在表单项下方

### 13.5 空状态
- 使用 `el-empty` 组件
- 自定义空状态图标和文字
- 提供操作按钮（如"创建第一个代理服务"）

## 十四、响应式设计细节

### 14.1 桌面端（≥1200px）
- 完整布局，侧边栏固定宽度200px
- 表格完整显示所有列
- 对话框宽度：50%屏幕宽度

### 14.2 平板端（768px-1199px）
- 侧边栏可折叠
- 表格支持横向滚动
- 对话框宽度：70%屏幕宽度

### 14.3 移动端（<768px）
- 侧边栏改为抽屉式（`el-drawer`）
- 表格改为卡片式布局
- 对话框全屏显示
- 按钮组垂直排列

## 十五、UI组件库使用规范

### 15.1 Element Plus组件
- **表单**: `el-form`, `el-form-item`, `el-input`, `el-select`
- **按钮**: `el-button`
- **表格**: `el-table`, `el-table-column`
- **对话框**: `el-dialog`
- **标签**: `el-tag`
- **开关**: `el-switch`
- **消息**: `el-message`, `el-message-box`
- **加载**: `el-loading`
- **空状态**: `el-empty`
- **折叠面板**: `el-collapse`, `el-collapse-item`
- **描述列表**: `el-descriptions`, `el-descriptions-item`

### 15.2 自定义组件
- 密码强度指示器
- Host标签输入组件
- 日志查看器组件

## 十六、颜色和样式规范

### 16.1 状态颜色
- **成功/运行中**: #67C23A (绿色)
- **信息/已停止**: #909399 (灰色)
- **警告**: #E6A23C (橙色)
- **危险/错误**: #F56C6C (红色)

### 16.2 主色调
- **主色**: Element Plus 默认蓝色 (#409EFF)
- **背景色**: #F5F7FA
- **文字色**: #303133 (主要文字), #606266 (常规文字), #909399 (次要文字)

### 16.3 间距规范
- 页面内边距：20px
- 表单项间距：20px
- 按钮间距：10px
- 卡片内边距：20px

## 十七、交互反馈规范

### 17.1 操作反馈
- 所有异步操作显示加载状态
- 操作成功显示成功提示（2秒自动消失）
- 操作失败显示错误提示（3秒自动消失）
- 危险操作需要二次确认

### 17.2 表单反馈
- 实时验证，错误信息即时显示
- 提交时进行完整验证
- 验证失败时滚动到第一个错误项

### 17.3 数据更新
- 列表数据变更后自动刷新
- 对话框关闭后刷新相关数据
- 使用乐观更新提升用户体验

## 十八、无障碍设计

### 18.1 键盘导航
- 支持Tab键导航
- 表单支持Enter提交
- 对话框支持ESC关闭

### 18.2 屏幕阅读器
- 所有交互元素添加适当的aria-label
- 表单错误信息关联到对应输入框
- 状态变化提供适当的提示

### 18.3 视觉反馈
- 按钮hover状态明显
- 链接有下划线或颜色区分
- 禁用状态视觉上明显
