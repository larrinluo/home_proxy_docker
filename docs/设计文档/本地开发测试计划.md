# 本地开发阶段测试计划

## 文档概述

### 测试目标

本文档旨在为"一键构建代理服务器docker"项目的本地开发阶段提供全面的测试计划，确保系统在进入Docker容器化部署阶段前，所有功能模块、集成流程、性能指标、安全性和用户体验均达到预期标准。

**主要测试目标包括：**

1. **功能完整性验证**：确保所有功能模块（用户认证、代理服务管理、Host配置管理、PAC配置生成、系统配置等）按照需求文档和设计文档正确实现
2. **系统稳定性验证**：验证系统在各种正常和异常场景下的稳定性和可靠性
3. **性能指标验证**：确保API响应时间、页面加载速度等性能指标满足要求
4. **安全性验证**：确保用户认证、数据加密、输入验证等安全机制有效
5. **用户体验验证**：确保UI界面、交互流程符合设计规范，提供良好的用户体验
6. **集成功能验证**：确保前后端、代理服务、数据库等各模块之间的集成正常工作

### 测试范围

**包含的测试范围：**

1. **功能测试**
   - 用户认证模块：注册、登录、注销、获取用户信息
   - 用户管理模块：修改密码、更新个人信息
   - 代理服务管理模块：创建、编辑、删除、启动、停止、状态查询
   - Host配置管理模块：创建、编辑、删除、冲突检测
   - PAC配置生成模块：配置生成、获取、实时更新、验证
   - 系统配置模块：获取、更新系统全局配置

2. **集成测试**
   - 前后端API集成测试
   - 代理服务（SSH、autossh）集成测试
   - 数据库操作集成测试

3. **性能测试**
   - API响应时间测试
   - 页面加载性能测试
   - 并发请求处理测试

4. **安全测试**
   - 认证安全测试
   - 输入验证和防护测试
   - 权限控制测试

5. **UI/UX测试**
   - 界面布局测试
   - 交互功能测试
   - 响应式设计测试
   - 浏览器兼容性测试

6. **边界和异常测试**
   - 边界值测试
   - 异常场景测试
   - 错误处理测试

**不包含的测试范围：**

- Docker容器化部署测试（属于第二阶段）
- 生产环境部署测试
- 大规模压力测试（本地开发阶段仅进行基础性能测试）
- 多架构（x86、arm64）兼容性测试（Docker阶段进行）

### 测试策略

**测试方法：**

1. **黑盒测试**：基于需求文档和API设计文档，测试功能是否符合预期
2. **白盒测试**：基于代码实现，测试关键逻辑和边界条件
3. **集成测试**：测试各模块之间的协作和数据流
4. **回归测试**：在修复缺陷后，验证相关功能是否受影响

**测试优先级：**

- **P0（高优先级）**：核心功能测试（用户认证、代理服务管理、Host配置管理）
- **P1（中优先级）**：重要功能测试（PAC配置生成、系统配置）
- **P2（低优先级）**：辅助功能测试（UI优化、性能优化）

**测试环境：**

- 本地开发环境（Node.js 18+、SQLite、Vue 3开发服务器）
- 测试用跳板服务器（用于代理服务测试）
- 主流浏览器（Chrome、Firefox、Safari、Edge）

**测试数据管理：**

- 使用独立的测试数据库
- 准备标准化的测试数据集
- 测试后清理测试数据，确保测试环境一致性

### 文档结构说明

本文档共分为九个主要章节：

1. **文档概述**：说明测试目标、范围、策略和文档结构
2. **测试环境准备**：描述测试环境要求、工具准备和数据准备
3. **功能测试**：按模块详细描述各功能模块的测试用例
4. **集成测试**：描述模块间集成测试的测试用例
5. **性能测试**：描述性能测试的方法和指标
6. **安全测试**：描述安全测试的测试用例
7. **UI/UX测试**：描述界面和用户体验测试的测试用例
8. **边界和异常测试**：描述边界值和异常场景的测试用例
9. **测试用例清单**：汇总所有测试用例，包含优先级和预期结果
10. **测试执行计划**：描述测试阶段划分、时间安排和缺陷管理流程

**文档使用说明：**

- 本文档作为测试执行的指导文档，测试人员应按照文档中的测试用例进行测试
- 测试过程中发现的问题应记录在缺陷管理系统中
- 测试完成后应生成测试报告，总结测试结果和发现的问题

---

## 一、测试环境准备

### 1.1 开发环境要求

**硬件要求：**

- CPU：2核及以上
- 内存：4GB及以上
- 磁盘空间：至少10GB可用空间
- 网络：能够访问测试用跳板服务器

**软件要求：**

1. **操作系统**
   - **后端服务器**：Ubuntu（域名：`t58`）
   - **前端开发**：macOS（本机）
   - Windows 10/11（需安装WSL2或Git Bash）

2. **Node.js环境**
   - Node.js版本：18.x或更高版本
   - npm版本：9.x或更高版本
   - 验证命令：`node --version`、`npm --version`

3. **数据库**
   - SQLite 3.x（Node.js环境自带）
   - 验证命令：`sqlite3 --version`

4. **SSH工具**
   - OpenSSH客户端（Linux/macOS自带）
   - autossh工具（用于代理服务测试）
   - 安装命令（Ubuntu/Debian）：`sudo apt-get install autossh openssh-client`
   - 安装命令（macOS）：`brew install autossh`

5. **代码编辑器**
   - VS Code（推荐）或其他支持JavaScript/TypeScript的编辑器

6. **浏览器**
   - Chrome 90+（推荐）
   - Firefox 88+
   - Safari 14+
   - Edge 90+

7. **Git**
   - Git 2.30+（用于版本控制）

**环境变量配置：**

创建`.env`文件（后端）和`.env.development`文件（前端），配置以下环境变量：

```bash
# 后端环境变量 (.env) - 在t58服务器上配置
NODE_ENV=development
PORT=3100
DATABASE_PATH=./data/test-database.db
SESSION_SECRET=test-session-secret-key
PROXY_HOST=t58
PROXY_PORT=8090
LOG_LEVEL=debug

# 前端环境变量 (.env.development) - 在本机macOS上配置
VITE_API_BASE_URL=http://t58:3100
```

### 1.2 测试数据准备

**测试用户数据：**

准备以下测试用户账号：

| 用户名 | 密码 | 邮箱 | 用途 |
|--------|------|------|------|
| testuser1 | Test123456 | testuser1@example.com | 基础功能测试 |
| testuser2 | Test123456 | testuser2@example.com | 并发测试 |
| admin | Admin123456 | admin@example.com | 权限测试 |

**测试跳板服务器数据：**

准备至少一个测试用跳板服务器，包含以下信息：

| 服务器名称 | 主机地址 | 端口 | 用户名 | 密码 | 用途 |
|-----------|---------|------|--------|------|------|
| 测试跳板1 | 43.163.237.183 | 22 | larrin | TheDog@01 | 代理服务测试 |
| 测试跳板2 | 43.153.100.84 | 22 | larrin | TheDog@01 | 多代理服务测试 |

**测试Host数据：**

准备以下测试域名列表：

- google.com
- youtube.com
- facebook.com
- twitter.com
- instagram.com
- chatgpt.com
- github.com
- stackoverflow.com

**测试代理服务配置数据：**

准备标准化的代理服务配置模板：

**模板1：使用跳板服务器1**
```json
{
  "name": "测试代理服务1",
  "jump_host": "43.163.237.183",
  "jump_port": 22,
  "jump_username": "larrin",
  "password": "TheDog@01",
  "hosts": ["google.com", "youtube.com"]
}
```

**模板2：使用跳板服务器2**
```json
{
  "name": "测试代理服务2",
  "jump_host": "43.153.100.84",
  "jump_port": 22,
  "jump_username": "larrin",
  "password": "TheDog@01",
  "hosts": ["google.com", "youtube.com"]
}
```

**测试数据库初始化脚本：**

创建测试数据库初始化脚本，包含：
- 创建所有数据表
- 插入初始系统配置（register_enabled=true）
- 插入测试用户数据（可选）

### 1.3 测试工具准备

**API测试工具：**

1. **Postman**（推荐）
   - 用途：API接口测试
   - 下载地址：https://www.postman.com/downloads/
   - 配置：导入API集合，配置环境变量

2. **curl**（命令行工具）
   - 用途：快速API测试
   - 验证命令：`curl --version`

3. **HTTPie**（可选）
   - 用途：更友好的命令行HTTP客户端
   - 安装命令：`pip install httpie`

**前端测试工具：**

1. **Chrome DevTools**
   - 用途：页面调试、性能分析、网络监控
   - 使用方法：F12打开开发者工具

2. **Vue DevTools**
   - 用途：Vue组件调试
   - 安装：Chrome扩展商店安装Vue.js devtools

**性能测试工具：**

1. **Apache Bench (ab)**
   - 用途：API性能测试
   - 安装命令（Ubuntu）：`sudo apt-get install apache2-utils`
   - 安装命令（macOS）：`brew install httpd`

2. **k6**（可选）
   - 用途：负载测试
   - 安装命令：`brew install k6` 或参考 https://k6.io/docs/getting-started/installation/

**数据库管理工具：**

1. **DB Browser for SQLite**
   - 用途：SQLite数据库可视化管理
   - 下载地址：https://sqlitebrowser.org/

2. **命令行sqlite3**
   - 用途：快速数据库操作
   - 验证命令：`sqlite3 --version`

**代码质量工具：**

1. **ESLint**
   - 用途：JavaScript代码检查
   - 配置：项目根目录的`.eslintrc.js`

2. **Prettier**
   - 用途：代码格式化
   - 配置：项目根目录的`.prettierrc`

**版本控制工具：**

1. **Git**
   - 用途：代码版本管理
   - 验证命令：`git --version`

### 1.4 环境配置步骤

**步骤1：克隆项目代码**

```bash
git clone <repository-url>
cd socks_proxy_docker
```

**步骤2：安装后端依赖**

在t58服务器上执行：

```bash
cd server/back-end
npm install
```

**步骤3：安装前端依赖**

在本机macOS上执行：

```bash
cd server/front-end
npm install
```

**步骤4：初始化测试数据库**

在t58服务器上执行：

```bash
cd server/back-end
node scripts/init-db.js
# 或使用测试数据库初始化脚本
node scripts/init-test-db.js
```

**步骤5：配置环境变量**

在t58服务器后端项目根目录创建`.env`文件：

```bash
cd server/back-end
cp .env.example .env
# 编辑.env文件，配置测试环境变量
# PROXY_HOST=t58
# PORT=3100
```

在本机macOS前端项目根目录创建`.env.development`文件：

```bash
cd server/front-end
cp .env.development.example .env.development
# 编辑.env.development文件，配置API地址
# VITE_API_BASE_URL=http://t58:3100
```

**步骤6：启动后端服务**

在t58服务器上执行：

```bash
cd server/back-end
npm run dev
# 或
nodemon server.js
```

验证后端服务启动成功：
- 访问 http://t58:3100/health 应返回200状态码
- 或在本机macOS上访问：`curl http://t58:3100/health`

**步骤7：启动前端开发服务器**

**在本机macOS上执行：**

```bash
cd server/front-end
npm run dev
```

验证前端服务启动成功：
- 访问 http://localhost:5173（Vite默认端口）应显示登录页面
- 前端会自动连接到后端API（http://t58:3100）

**步骤8：准备测试用跳板服务器**

验证跳板服务器连接：

```bash
# 验证跳板服务器1连接
ssh larrin@43.163.237.183
# 输入密码：TheDog@01

# 验证跳板服务器2连接
ssh larrin@43.153.100.84
# 输入密码：TheDog@01
```

确保测试用跳板服务器满足以下条件：
- SSH服务正常运行
- 可以通过密码登录
- 有足够的权限创建SSH密钥授权

**步骤9：验证环境配置**

执行以下验证步骤：

1. **验证Node.js环境**
   ```bash
   node --version
   npm --version
   ```

2. **验证数据库连接**（在t58服务器上）
   ```bash
   sqlite3 ./data/test-database.db "SELECT name FROM sqlite_master WHERE type='table';"
   ```

3. **验证后端API**（在本机macOS上）
   ```bash
   curl http://t58:3100/api/v1/system-configs
   ```
   或访问：http://t58:3100/api/v1/system-configs

4. **验证前端页面**（在本机macOS上）
   - 浏览器访问 http://localhost:5173
   - 应显示登录页面
   - 前端应能正常调用后端API（http://t58:3100）

5. **验证SSH工具**
   ```bash
   ssh -V
   autossh -V
   ```

**步骤10：配置测试工具**

1. **配置Postman**
   - 创建新的Environment：`本地开发环境`
   - 配置变量：
     - `base_url`: http://t58:3100
     - `frontend_url`: http://localhost:5173
   - 导入API集合（如果有）

2. **配置测试数据**
   - 在测试数据目录准备测试数据文件
   - 配置测试脚本使用的数据路径

**环境配置检查清单：**

- [ ] Node.js和npm已安装并验证版本
- [ ] 后端依赖已安装
- [ ] 前端依赖已安装
- [ ] 测试数据库已初始化
- [ ] 环境变量已配置
- [ ] 后端服务可以正常启动（t58服务器）
- [ ] 前端服务可以正常启动（本机macOS）
- [ ] 后端服务器t58可访问（从本机macOS）
- [ ] 跳板服务器1（43.163.237.183）可访问
- [ ] 跳板服务器2（43.153.100.84）可访问
- [ ] SSH和autossh工具已安装
- [ ] 测试工具（Postman等）已配置
- [ ] 浏览器可以访问前端页面（本机macOS）

---

## 二、功能测试

### 2.1 用户认证模块测试

#### 2.1.1 用户注册功能测试

**测试用例 TC-AUTH-001：正常注册流程**

- **前置条件**：系统注册功能已开启（register_enabled=true）
- **测试步骤**：
  1. 访问注册页面
  2. 输入用户名：`newuser`
  3. 输入密码：`Test123456`
  4. 输入邮箱：`newuser@example.com`（可选）
  5. 点击注册按钮
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含用户信息（不包含密码）
  - 数据库中创建新用户记录
  - 密码已加密存储（bcrypt哈希）
  - 自动登录或跳转到登录页面

**测试用例 TC-AUTH-002：用户名已存在**

- **前置条件**：数据库中已存在用户名为`testuser1`的记录
- **测试步骤**：
  1. 访问注册页面
  2. 输入用户名：`testuser1`
  3. 输入密码：`Test123456`
  4. 点击注册按钮
- **预期结果**：
  - 返回错误响应，状态码409 Conflict
  - 错误信息："用户名已存在"
  - 数据库中未创建新记录

**测试用例 TC-AUTH-003：注册功能已关闭**

- **前置条件**：系统注册功能已关闭（register_enabled=false）
- **测试步骤**：
  1. 访问注册页面
  2. 输入注册信息
  3. 点击注册按钮
- **预期结果**：
  - 返回错误响应，状态码403 Forbidden
  - 错误信息："注册功能已关闭"
  - 注册页面显示提示信息

**测试用例 TC-AUTH-004：参数验证失败**

- **测试步骤**：
  1. 访问注册页面
  2. 输入用户名：`ab`（少于3个字符）
  3. 输入密码：`123`（少于8个字符）
  4. 点击注册按钮
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息包含参数验证失败详情
  - 前端显示验证错误提示

#### 2.1.2 用户登录功能测试

**测试用例 TC-AUTH-005：正常登录流程**

- **前置条件**：数据库中已存在用户名为`testuser1`，密码为`Test123456`的用户
- **测试步骤**：
  1. 访问登录页面
  2. 输入用户名：`testuser1`
  3. 输入密码：`Test123456`
  4. 点击登录按钮
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含用户信息
  - 设置Session Cookie
  - 跳转到主页面（Dashboard）

**测试用例 TC-AUTH-006：用户名或密码错误**

- **测试步骤**：
  1. 访问登录页面
  2. 输入用户名：`testuser1`
  3. 输入密码：`WrongPassword`
  4. 点击登录按钮
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
  - 错误信息："用户名或密码错误"（不区分用户名或密码错误）
  - 未设置Session Cookie
  - 停留在登录页面

**测试用例 TC-AUTH-007：用户不存在**

- **测试步骤**：
  1. 访问登录页面
  2. 输入用户名：`nonexistentuser`
  3. 输入密码：`Test123456`
  4. 点击登录按钮
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
  - 错误信息："用户名或密码错误"
  - 未设置Session Cookie

**测试用例 TC-AUTH-008：登录后Session有效性**

- **前置条件**：已成功登录
- **测试步骤**：
  1. 登录成功后，访问需要认证的API（如`/api/v1/proxy-services`）
  2. 检查请求头中是否包含Session Cookie
- **预期结果**：
  - API请求成功，返回数据
  - Session Cookie有效

#### 2.1.3 用户注销功能测试

**测试用例 TC-AUTH-009：正常注销流程**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 点击注销按钮
  2. 确认注销操作
- **预期结果**：
  - 返回成功响应，状态码200
  - Session Cookie被清除
  - 跳转到登录页面
  - 后续访问需要认证的API返回401

**测试用例 TC-AUTH-010：未登录时注销**

- **前置条件**：用户未登录
- **测试步骤**：
  1. 直接访问注销API：`POST /api/v1/auth/logout`
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
  - 错误信息："未登录"

#### 2.1.4 获取当前用户信息测试

**测试用例 TC-AUTH-011：获取已登录用户信息**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问API：`GET /api/v1/auth/me`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含用户信息（id、username、email、created_at）
  - 不包含密码字段

**测试用例 TC-AUTH-012：未登录时获取用户信息**

- **前置条件**：用户未登录
- **测试步骤**：
  1. 访问API：`GET /api/v1/auth/me`
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
  - 错误信息："未登录"

### 2.2 用户管理模块测试

#### 2.2.1 修改密码功能测试

**测试用例 TC-USER-001：正常修改密码流程**

- **前置条件**：用户已登录，当前密码为`Test123456`
- **测试步骤**：
  1. 访问修改密码页面
  2. 输入旧密码：`Test123456`
  3. 输入新密码：`NewPassword123`
  4. 确认新密码：`NewPassword123`
  5. 点击保存按钮
- **预期结果**：
  - 返回成功响应，状态码200
   - 密码修改成功提示
   - 使用新密码可以登录
   - 使用旧密码无法登录

**测试用例 TC-USER-002：旧密码错误**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问修改密码页面
  2. 输入旧密码：`WrongPassword`
  3. 输入新密码：`NewPassword123`
  4. 点击保存按钮
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
   - 错误信息："旧密码错误"
   - 密码未修改

**测试用例 TC-USER-003：新密码格式验证**

- **测试步骤**：
  1. 访问修改密码页面
  2. 输入旧密码：`Test123456`
  3. 输入新密码：`123`（少于8个字符）
  4. 点击保存按钮
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息包含密码格式要求
  - 前端显示验证错误提示

#### 2.2.2 更新用户信息测试

**测试用例 TC-USER-004：更新邮箱**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问个人信息页面
  2. 修改邮箱为：`newemail@example.com`
  3. 点击保存按钮
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含更新后的用户信息
  - 数据库中邮箱已更新

**测试用例 TC-USER-005：邮箱格式验证**

- **测试步骤**：
  1. 访问个人信息页面
  2. 输入无效邮箱：`invalid-email`
  3. 点击保存按钮
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息包含邮箱格式要求
  - 前端显示验证错误提示

### 2.3 代理服务管理模块测试

#### 2.3.1 创建代理服务测试

**测试用例 TC-PROXY-001：正常创建代理服务流程**

- **前置条件**：用户已登录，测试跳板服务器可访问
- **测试步骤**：
  1. 访问代理服务管理页面
  2. 点击"添加新配置"按钮
  3. 填写代理服务名称：`测试代理1`
  4. 填写跳板服务器信息：
     - 主机地址：`43.163.237.183`
     - 端口：`22`
     - 用户名：`larrin`
     - 密码：`TheDog@01`
  5. 添加Host列表：`google.com, youtube.com`
  6. 点击创建按钮
  7. 观察日志窗口显示的操作过程
- **预期结果**：
  - 日志窗口显示SSH密钥生成过程
  - 日志窗口显示SSH连接测试结果
  - 日志窗口显示公钥传输过程
  - 日志窗口显示代理服务创建和启动过程
  - 返回成功响应，状态码201 Created
  - 响应体包含代理服务信息（id、proxy_port、status等）
  - 数据库中创建代理服务记录
  - 数据库中创建关联的Host配置记录
  - SSH密钥文件已生成
  - autossh进程已启动
  - 代理服务状态为`running`

**测试用例 TC-PROXY-002：SSH连接失败**

- **测试步骤**：
  1. 填写代理服务信息
  2. 填写错误的跳板服务器地址：`192.168.1.999`
  3. 点击创建按钮
- **预期结果**：
  - 日志窗口显示SSH连接失败错误
  - 返回错误响应，状态码502 Bad Gateway
  - 错误信息："无法连接到跳板服务器"
  - 未创建代理服务记录

**测试用例 TC-PROXY-003：SSH认证失败**

- **测试步骤**：
  1. 填写代理服务信息
  2. 填写错误的密码：`WrongPassword`
  3. 点击创建按钮
- **预期结果**：
  - 日志窗口显示认证失败错误
  - 返回错误响应，状态码502 Bad Gateway
  - 错误信息："用户名或密码错误"
  - 未创建代理服务记录

**测试用例 TC-PROXY-004：端口已占用**

- **前置条件**：端口11081已被其他代理服务占用
- **测试步骤**：
  1. 创建新的代理服务
  2. 系统尝试分配端口11081
- **预期结果**：
  - 系统自动选择下一个可用端口（11082）
  - 如果所有端口都被占用，返回错误响应，状态码409 Conflict
  - 错误信息："代理端口已被占用"

**测试用例 TC-PROXY-005：自动创建Host配置**

- **测试步骤**：
  1. 创建代理服务时提供Host列表：`google.com, youtube.com`
  2. 创建成功后检查Host配置
- **预期结果**：
  - 自动创建Host配置记录
  - Host配置关联到新创建的代理服务
  - Host配置名称默认为代理服务名称或"默认配置"

#### 2.3.2 获取代理服务列表测试

**测试用例 TC-PROXY-006：获取代理服务列表**

- **前置条件**：数据库中已存在多个代理服务记录
- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services`
  2. 可选参数：`?page=1&pageSize=10&status=running`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含代理服务列表（items数组）
  - 响应体包含分页信息（total、page、pageSize）
  - 每个代理服务包含完整信息（id、name、jump_host、proxy_port、status等）

**测试用例 TC-PROXY-007：按状态筛选**

- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services?status=running`
- **预期结果**：
  - 返回的代理服务列表只包含状态为`running`的服务
  - 其他状态的代理服务不包含在结果中

**测试用例 TC-PROXY-008：分页功能**

- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services?page=2&pageSize=5`
- **预期结果**：
  - 返回第2页的数据
  - 每页包含最多5条记录
  - 分页信息正确

#### 2.3.3 获取代理服务详情测试

**测试用例 TC-PROXY-009：获取存在的代理服务详情**

- **前置条件**：数据库中已存在id为1的代理服务
- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services/1`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含代理服务的完整详细信息

**测试用例 TC-PROXY-010：获取不存在的代理服务详情**

- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services/99999`
- **预期结果**：
  - 返回错误响应，状态码404 Not Found
  - 错误信息："代理服务不存在"

#### 2.3.4 更新代理服务测试

**测试用例 TC-PROXY-011：更新代理服务名称**

- **前置条件**：已存在id为1的代理服务
- **测试步骤**：
  1. 访问API：`PUT /api/v1/proxy-services/1`
  2. 请求体：`{"name": "更新后的名称"}`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含更新后的代理服务信息
  - 数据库中名称已更新

**测试用例 TC-PROXY-012：更新跳板服务器信息**

- **测试步骤**：
  1. 更新跳板服务器地址和密码
  2. 观察日志窗口
- **预期结果**：
  - 日志窗口显示重新连接和公钥推送过程
  - 如果代理服务正在运行，自动重启
  - 更新成功

#### 2.3.5 删除代理服务测试

**测试用例 TC-PROXY-013：正常删除代理服务**

- **前置条件**：已存在id为1的代理服务，状态为running
- **测试步骤**：
  1. 访问API：`DELETE /api/v1/proxy-services/1`
  2. 确认删除操作
- **预期结果**：
  - 返回成功响应，状态码200
  - autossh进程已停止
  - SSH密钥文件已删除
  - 关联的Host配置已删除（CASCADE）
  - 代理服务记录已从数据库删除
  - PAC配置自动重新生成

**测试用例 TC-PROXY-014：删除不存在的代理服务**

- **测试步骤**：
  1. 访问API：`DELETE /api/v1/proxy-services/99999`
- **预期结果**：
  - 返回错误响应，状态码404 Not Found
  - 错误信息："代理服务不存在"

#### 2.3.6 启动代理服务测试

**测试用例 TC-PROXY-015：启动已停止的代理服务**

- **前置条件**：已存在id为1的代理服务，状态为stopped
- **测试步骤**：
  1. 访问API：`POST /api/v1/proxy-services/1/start`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体显示状态为`running`
  - autossh进程已启动
  - 数据库中状态已更新为`running`
  - 代理端口可以正常连接

**测试用例 TC-PROXY-016：启动已运行的代理服务**

- **前置条件**：代理服务状态为running
- **测试步骤**：
  1. 访问API：`POST /api/v1/proxy-services/1/start`
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息："代理服务已在运行"

#### 2.3.7 停止代理服务测试

**测试用例 TC-PROXY-017：停止运行中的代理服务**

- **前置条件**：代理服务状态为running
- **测试步骤**：
  1. 访问API：`POST /api/v1/proxy-services/1/stop`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体显示状态为`stopped`
  - autossh进程已停止
  - 数据库中状态已更新为`stopped`
  - 代理端口无法连接

**测试用例 TC-PROXY-018：停止已停止的代理服务**

- **前置条件**：代理服务状态为stopped
- **测试步骤**：
  1. 访问API：`POST /api/v1/proxy-services/1/stop`
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息："代理服务已停止"

#### 2.3.8 获取代理服务状态测试

**测试用例 TC-PROXY-019：获取代理服务状态**

- **前置条件**：已存在id为1的代理服务
- **测试步骤**：
  1. 访问API：`GET /api/v1/proxy-services/1/status`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含状态信息（status、proxy_port、process_id等）
  - 状态与实际运行状态一致

**测试用例 TC-PROXY-020：状态实时检查**

- **测试步骤**：
  1. 启动代理服务
  2. 立即查询状态
  3. 停止代理服务
  4. 立即查询状态
- **预期结果**：
  - 状态查询结果与实际状态一致
  - 状态更新及时

### 2.4 Host配置管理模块测试

#### 2.4.1 创建Host配置测试

**测试用例 TC-HOST-001：正常创建Host配置**

- **前置条件**：已存在id为1的代理服务
- **测试步骤**：
  1. 访问API：`POST /api/v1/host-configs`
  2. 请求体：
     ```json
     {
       "name": "测试配置",
       "proxy_service_id": 1,
       "hosts": ["facebook.com", "twitter.com"]
     }
     ```
- **预期结果**：
  - 返回成功响应，状态码201 Created
  - 响应体包含Host配置信息
  - 数据库中创建Host配置记录
  - PAC配置自动重新生成

**测试用例 TC-HOST-002：Host冲突检测**

- **前置条件**：已存在Host配置包含`google.com`
- **测试步骤**：
  1. 创建新Host配置，包含`google.com`
- **预期结果**：
  - 返回错误响应，状态码409 Conflict
  - 错误信息："Host配置冲突"
  - 错误详情包含冲突的Host和配置信息
  - 未创建Host配置记录

**测试用例 TC-PROXY-003：代理服务不存在**

- **测试步骤**：
  1. 创建Host配置，proxy_service_id为99999
- **预期结果**：
  - 返回错误响应，状态码400 Bad Request
  - 错误信息："代理服务不存在"

#### 2.4.2 获取Host配置列表测试

**测试用例 TC-HOST-004：获取Host配置列表**

- **前置条件**：数据库中已存在多个Host配置
- **测试步骤**：
  1. 访问API：`GET /api/v1/host-configs`
  2. 可选参数：`?proxy_service_id=1`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含Host配置列表
  - 每个配置包含关联的代理服务信息

**测试用例 TC-HOST-005：按代理服务筛选**

- **测试步骤**：
  1. 访问API：`GET /api/v1/host-configs?proxy_service_id=1`
- **预期结果**：
  - 返回的列表只包含关联到代理服务1的配置
  - 其他配置不包含在结果中

#### 2.4.3 获取Host配置详情测试

**测试用例 TC-HOST-006：获取Host配置详情**

- **前置条件**：已存在id为1的Host配置
- **测试步骤**：
  1. 访问API：`GET /api/v1/host-configs/1`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含Host配置的完整信息
  - hosts字段为JSON数组格式

#### 2.4.4 更新Host配置测试

**测试用例 TC-HOST-007：更新Host列表**

- **前置条件**：已存在id为1的Host配置
- **测试步骤**：
  1. 访问API：`PUT /api/v1/host-configs/1`
  2. 请求体：
     ```json
     {
       "name": "更新后的配置",
       "proxy_service_id": 1,
       "hosts": ["google.com", "youtube.com", "chatgpt.com"]
     }
     ```
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含更新后的配置信息
  - 数据库中配置已更新
  - PAC配置自动重新生成

**测试用例 TC-HOST-008：更新后Host冲突检测**

- **前置条件**：已存在其他Host配置包含`google.com`
- **测试步骤**：
  1. 更新Host配置，添加`google.com`
- **预期结果**：
  - 返回错误响应，状态码409 Conflict
  - 错误信息："Host配置冲突"
  - 配置未更新

#### 2.4.5 删除Host配置测试

**测试用例 TC-HOST-009：删除Host配置**

- **前置条件**：已存在id为1的Host配置
- **测试步骤**：
  1. 访问API：`DELETE /api/v1/host-configs/1`
- **预期结果**：
  - 返回成功响应，状态码200
  - Host配置记录已从数据库删除
  - PAC配置自动重新生成

#### 2.4.6 Host冲突检测测试

**测试用例 TC-HOST-010：检查Host冲突API**

- **前置条件**：已存在Host配置包含`google.com`
- **测试步骤**：
  1. 访问API：`POST /api/v1/host-configs/check-conflict`
  2. 请求体：
     ```json
     {
       "hosts": ["google.com", "youtube.com"],
       "exclude_config_id": null
     }
     ```
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含冲突检测结果
  - hasConflict为true
  - conflicts数组包含冲突的Host信息

**测试用例 TC-HOST-011：排除自身配置的冲突检测**

- **测试步骤**：
  1. 更新id为1的Host配置
  2. 检查冲突时排除自身：`exclude_config_id=1`
- **预期结果**：
  - 冲突检测时排除配置1
  - 如果只有配置1包含该Host，则无冲突

### 2.5 PAC配置生成模块测试

#### 2.5.1 PAC配置生成测试

**测试用例 TC-PAC-001：生成PAC配置**

- **前置条件**：已存在多个Host配置和关联的代理服务
- **测试步骤**：
  1. 访问API：`GET /api/v1/pac/config`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含PAC配置JSON
  - proxyRules数组包含所有Host配置的代理规则
  - 每个规则包含domains和proxy字段
  - direct字段为true
  - 代理地址格式正确：`SOCKS5 {host}:{port}`

**测试用例 TC-PAC-002：只包含运行中的代理服务**

- **前置条件**：存在多个代理服务，部分为running，部分为stopped
- **测试步骤**：
  1. 生成PAC配置
- **预期结果**：
  - PAC配置只包含状态为running的代理服务
  - stopped状态的代理服务不包含在配置中

#### 2.5.2 PAC配置获取测试

**测试用例 TC-PAC-003：获取PAC文件**

- **测试步骤**：
  1. 访问PAC文件：`GET /proxy.pac`
- **预期结果**：
  - 返回成功响应，状态码200
  - Content-Type为`application/x-ns-proxy-autoconfig`
  - 返回JSON格式的PAC配置
  - 允许跨域访问（CORS）

**测试用例 TC-PAC-004：PAC文件无需认证**

- **前置条件**：用户未登录
- **测试步骤**：
  1. 访问PAC文件：`GET /proxy.pac`
- **预期结果**：
  - 返回成功响应，状态码200
  - 可以正常访问（PAC文件供客户端使用，无需认证）

#### 2.5.3 PAC配置实时更新测试

**测试用例 TC-PAC-005：Host配置更新后PAC自动更新**

- **前置条件**：已存在Host配置和PAC配置
- **测试步骤**：
  1. 更新Host配置，添加新Host
  2. 立即获取PAC配置
- **预期结果**：
  - PAC配置立即更新
   - 新Host包含在对应的代理规则中

**测试用例 TC-PAC-006：代理服务状态变化后PAC更新**

- **测试步骤**：
  1. 停止一个代理服务
  2. 获取PAC配置
- **预期结果**：
  - PAC配置自动更新
   - 停止的代理服务不再包含在配置中

**测试用例 TC-PAC-007：代理服务删除后PAC更新**

- **测试步骤**：
  1. 删除一个代理服务
  2. 获取PAC配置
- **预期结果**：
  - PAC配置自动更新
   - 删除的代理服务及其Host配置不再包含在配置中

#### 2.5.4 PAC配置验证测试

**测试用例 TC-PAC-008：PAC配置格式验证**

- **测试步骤**：
  1. 获取PAC配置
  2. 验证JSON格式
- **预期结果**：
  - JSON格式正确
  - 包含必需字段（proxyRules、direct）
  - proxyRules为数组
  - 每个规则包含domains和proxy字段

**测试用例 TC-PAC-009：代理地址格式验证**

- **测试步骤**：
  1. 获取PAC配置
  2. 检查代理地址格式
- **预期结果**：
  - 代理地址格式为：`SOCKS5 {IP}:{port}`
  - IP地址格式正确
  - 端口号在有效范围内（11081-11082）

### 2.6 系统配置模块测试

#### 2.6.1 获取系统配置列表测试

**测试用例 TC-SYS-001：获取系统配置列表**

- **测试步骤**：
  1. 访问API：`GET /api/v1/system-configs`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含系统配置列表
  - 包含register_enabled配置项
  - 每个配置项包含key、value、description

#### 2.6.2 获取单个系统配置测试

**测试用例 TC-SYS-002：获取register_enabled配置**

- **测试步骤**：
  1. 访问API：`GET /api/v1/system-configs/register_enabled`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含register_enabled配置的详细信息
  - value字段为boolean类型

**测试用例 TC-SYS-003：获取不存在的配置**

- **测试步骤**：
  1. 访问API：`GET /api/v1/system-configs/nonexistent_key`
- **预期结果**：
  - 返回错误响应，状态码404 Not Found
  - 错误信息："系统配置不存在"

#### 2.6.3 更新系统配置测试

**测试用例 TC-SYS-004：更新register_enabled配置**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问API：`PUT /api/v1/system-configs/register_enabled`
  2. 请求体：`{"value": false}`
- **预期结果**：
  - 返回成功响应，状态码200
  - 响应体包含更新后的配置信息
  - 数据库中配置已更新
  - 注册功能已关闭（新用户无法注册）

**测试用例 TC-SYS-005：未登录时更新配置**

- **前置条件**：用户未登录
- **测试步骤**：
  1. 访问API：`PUT /api/v1/system-configs/register_enabled`
- **预期结果**：
  - 返回错误响应，状态码401 Unauthorized
  - 错误信息："未登录"

---

## 三、集成测试

### 3.1 前后端集成测试

#### 3.1.1 API调用流程测试

**测试用例 TC-INT-001：完整用户注册登录流程**

- **测试步骤**：
  1. 前端：访问注册页面
  2. 前端：填写注册表单并提交
  3. 前端：调用后端API `POST /api/v1/auth/register`
  4. 后端：处理注册请求，创建用户
  5. 前端：接收响应，显示成功提示
  6. 前端：自动跳转到登录页面（或自动登录）
  7. 前端：填写登录表单并提交
  8. 前端：调用后端API `POST /api/v1/auth/login`
  9. 后端：验证用户信息，创建Session
  10. 前端：接收响应，保存Session Cookie
  11. 前端：跳转到主页面
- **预期结果**：
  - 前后端通信正常
  - API调用成功
  - 数据正确传递
  - Session正确设置
  - 页面跳转正常

**测试用例 TC-INT-002：代理服务创建完整流程**

- **测试步骤**：
  1. 前端：点击"添加新配置"按钮
  2. 前端：打开代理服务创建弹窗
  3. 前端：填写代理服务表单
  4. 前端：点击创建按钮
  5. 前端：调用后端API `POST /api/v1/proxy-services`
  6. 后端：生成SSH密钥
  7. 后端：连接跳板服务器
  8. 后端：推送公钥
  9. 后端：创建代理服务记录
  10. 后端：启动autossh进程
  11. 后端：创建Host配置
  12. 后端：返回响应（包含过程日志）
  13. 前端：显示日志窗口，实时显示操作过程
  14. 前端：接收响应，显示成功提示
  15. 前端：刷新代理服务列表
  16. 前端：更新PAC配置预览
- **预期结果**：
  - 前后端数据流正常
  - 日志实时显示
  - 代理服务创建成功
  - 前端状态正确更新

**测试用例 TC-INT-003：Host配置更新触发PAC更新**

- **测试步骤**：
  1. 前端：打开Host配置标签页
  2. 前端：修改Host列表
  3. 前端：点击保存按钮
  4. 前端：调用后端API `PUT /api/v1/host-configs/:id`
  5. 后端：更新Host配置
  6. 后端：重新生成PAC配置
  7. 后端：返回响应
  8. 前端：接收响应
  9. 前端：自动刷新PAC配置预览标签页
- **预期结果**：
  - Host配置更新成功
  - PAC配置自动更新
  - PAC预览实时刷新

#### 3.1.2 数据流测试

**测试用例 TC-INT-004：数据从前端到数据库的完整流程**

- **测试步骤**：
  1. 前端：用户输入代理服务信息
  2. 前端：表单验证通过
  3. 前端：发送API请求（JSON格式）
  4. 后端：接收请求，解析JSON
  5. 后端：验证参数
  6. 后端：执行业务逻辑
  7. 后端：操作数据库（INSERT）
  8. 后端：返回响应（JSON格式）
  9. 前端：接收响应，解析JSON
  10. 前端：更新UI状态
- **预期结果**：
  - 数据格式正确（JSON）
  - 数据完整性保持
  - 数据正确存储到数据库
  - 响应数据正确返回

**测试用例 TC-INT-005：数据从数据库到前端的完整流程**

- **测试步骤**：
  1. 前端：请求代理服务列表
  2. 前端：调用API `GET /api/v1/proxy-services`
  3. 后端：查询数据库
  4. 后端：格式化数据
  5. 后端：返回JSON响应
  6. 前端：解析响应
  7. 前端：渲染代理配置卡片列表
- **预期结果**：
  - 数据库查询正确
  - 数据格式正确
  - 前端正确渲染
  - 数据显示完整

#### 3.1.3 认证流程测试

**测试用例 TC-INT-006：Session认证完整流程**

- **测试步骤**：
  1. 前端：用户登录
  2. 后端：创建Session，设置Cookie
  3. 前端：保存Cookie
  4. 前端：访问需要认证的页面
  5. 前端：调用需要认证的API
  6. 前端：自动在请求头中携带Cookie
  7. 后端：验证Session
  8. 后端：处理请求
  9. 后端：返回响应
- **预期结果**：
  - Session正确创建
  - Cookie正确设置
  - 前端自动携带Cookie
  - 后端正确验证Session
  - 认证流程顺畅

**测试用例 TC-INT-007：Session过期处理**

- **测试步骤**：
  1. 用户登录
  2. 等待Session过期（或手动清除Session）
  3. 前端：调用需要认证的API
  4. 后端：验证Session失败
  5. 后端：返回401错误
  6. 前端：拦截401错误
  7. 前端：清除本地Session信息
  8. 前端：跳转到登录页面
- **预期结果**：
  - Session过期正确检测
  - 401错误正确返回
  - 前端正确处理认证失败
  - 自动跳转到登录页

### 3.2 代理服务集成测试

#### 3.2.1 SSH连接测试

**测试用例 TC-INT-008：SSH连接和密钥推送集成**

- **前置条件**：测试跳板服务器可访问
- **测试步骤**：
  1. 后端：生成SSH密钥对
  2. 后端：使用密码连接跳板服务器
  3. 后端：读取公钥内容
  4. 后端：检查`~/.ssh/authorized_keys`文件
  5. 后端：追加公钥到authorized_keys
  6. 后端：设置正确的文件权限
  7. 后端：验证密钥认证是否成功
- **预期结果**：
  - SSH密钥生成成功
  - SSH连接成功
  - 公钥正确推送到跳板服务器
  - 文件权限正确设置
  - 密钥认证成功

**测试用例 TC-INT-009：SSH连接失败处理**

- **测试步骤**：
  1. 使用错误的跳板服务器地址
  2. 尝试SSH连接
  3. 捕获连接错误
  4. 返回错误信息给前端
- **预期结果**：
  - 连接错误正确捕获
  - 错误信息清晰
  - 前端正确显示错误

#### 3.2.2 代理服务创建流程测试

**测试用例 TC-INT-010：代理服务完整创建流程**

- **测试步骤**：
  1. 用户提交代理服务创建请求
  2. 后端：验证输入参数
  3. 后端：分配代理端口（11081-11082）
  4. 后端：生成SSH密钥对
  5. 后端：使用密码连接跳板服务器
  6. 后端：推送SSH公钥
  7. 后端：创建数据库记录（proxy_services表）
  8. 后端：启动autossh进程
  9. 后端：验证autossh进程运行状态
  10. 后端：更新数据库状态为running
  11. 后端：创建关联的Host配置（如果提供）
  12. 后端：生成PAC配置
  13. 后端：返回创建结果
- **预期结果**：
  - 所有步骤成功执行
  - 数据库记录正确创建
  - autossh进程正常运行
  - 代理端口可以连接
  - Host配置正确关联
  - PAC配置正确生成

**测试用例 TC-INT-011：代理服务创建失败回滚**

- **测试步骤**：
  1. 开始创建代理服务
  2. 在某个步骤失败（如SSH连接失败）
  3. 检查已执行的步骤是否回滚
- **预期结果**：
  - 已创建的数据库记录被删除
  - 已生成的SSH密钥文件被删除
  - 已启动的进程被停止
  - 系统状态保持一致

#### 3.2.3 代理服务启动/停止测试

**测试用例 TC-INT-012：代理服务启动流程**

- **前置条件**：已存在stopped状态的代理服务
- **测试步骤**：
  1. 后端：检查代理服务状态
  2. 后端：验证SSH密钥文件存在
  3. 后端：验证跳板服务器信息完整
  4. 后端：启动autossh进程
  5. 后端：等待进程启动
  6. 后端：检查进程状态
  7. 后端：检查端口监听状态
  8. 后端：更新数据库状态
- **预期结果**：
  - autossh进程成功启动
  - 进程ID正确记录
  - 端口正确监听
  - 数据库状态更新为running
  - 代理服务可以正常使用

**测试用例 TC-INT-013：代理服务停止流程**

- **前置条件**：已存在running状态的代理服务
- **测试步骤**：
  1. 后端：查找autossh进程（通过进程ID或端口）
  2. 后端：发送SIGTERM信号停止进程
  3. 后端：等待进程退出
  4. 后端：验证进程已停止
  5. 后端：验证端口已释放
  6. 后端：更新数据库状态
- **预期结果**：
  - autossh进程成功停止
  - 端口正确释放
  - 数据库状态更新为stopped
  - 代理服务无法连接

**测试用例 TC-INT-014：代理服务状态监控**

- **测试步骤**：
  1. 启动代理服务
  2. 定期检查进程状态（每30秒）
  3. 模拟进程异常退出
  4. 检查状态是否自动更新
- **预期结果**：
  - 状态检查机制正常工作
  - 进程异常退出能及时检测
  - 数据库状态自动更新为stopped或error

#### 3.2.4 PAC配置生成流程测试

**测试用例 TC-INT-015：PAC配置生成完整流程**

- **前置条件**：已存在多个Host配置和代理服务
- **测试步骤**：
  1. 后端：查询所有Host配置
  2. 后端：关联查询代理服务信息
  3. 后端：过滤只包含running状态的代理服务
  4. 后端：获取代理服务地址（PROXY_HOST环境变量或自动检测）
  5. 后端：构建代理规则数组
  6. 后端：生成PAC配置JSON
  7. 后端：验证配置格式
  8. 后端：保存配置到文件（/data/pac/config.json）
  9. 后端：返回配置给前端
- **预期结果**：
  - 查询逻辑正确
  - 代理规则正确构建
  - JSON格式正确
  - 配置文件正确保存
  - 配置内容正确

**测试用例 TC-INT-016：Host配置变化触发PAC更新**

- **测试步骤**：
  1. 创建Host配置
  2. 验证PAC配置自动更新
  3. 更新Host配置
  4. 验证PAC配置自动更新
  5. 删除Host配置
  6. 验证PAC配置自动更新
- **预期结果**：
  - 每次Host配置变化都触发PAC更新
  - PAC配置内容与Host配置一致
  - 更新及时

**测试用例 TC-INT-017：代理服务状态变化触发PAC更新**

- **测试步骤**：
  1. 启动代理服务
  2. 验证PAC配置包含该代理服务
  3. 停止代理服务
  4. 验证PAC配置不再包含该代理服务
- **预期结果**：
  - 代理服务状态变化触发PAC更新
  - PAC配置只包含running状态的代理服务

### 3.3 数据库集成测试

#### 3.3.1 数据库操作测试

**测试用例 TC-INT-018：数据库CRUD操作**

- **测试步骤**：
  1. 创建用户记录（INSERT）
  2. 查询用户记录（SELECT）
  3. 更新用户记录（UPDATE）
  4. 删除用户记录（DELETE）
- **预期结果**：
  - 所有CRUD操作成功
  - 数据正确存储和检索
  - 更新操作正确
  - 删除操作正确

**测试用例 TC-INT-019：数据库外键约束**

- **测试步骤**：
  1. 创建代理服务记录
  2. 创建关联的Host配置（proxy_service_id引用代理服务）
  3. 尝试删除代理服务
  4. 检查Host配置是否被级联删除（CASCADE）
- **预期结果**：
  - 外键约束正确工作
  - 删除代理服务时，关联的Host配置被级联删除
  - 数据库完整性保持

**测试用例 TC-INT-020：数据库唯一性约束**

- **测试步骤**：
  1. 创建用户名为`testuser`的用户
  2. 尝试创建相同用户名的用户
  3. 检查是否返回唯一性约束错误
- **预期结果**：
  - 唯一性约束正确工作
  - 重复数据无法插入
  - 返回适当的错误信息

#### 3.3.2 数据一致性测试

**测试用例 TC-INT-021：代理服务和Host配置数据一致性**

- **测试步骤**：
  1. 创建代理服务
  2. 创建关联的Host配置
  3. 查询Host配置，验证关联关系
  4. 更新代理服务信息
  5. 验证Host配置关联关系保持
  6. 删除代理服务
  7. 验证Host配置被级联删除
- **预期结果**：
  - 关联关系正确维护
  - 数据一致性保持
  - 级联操作正确执行

**测试用例 TC-INT-022：代理服务状态一致性**

- **测试步骤**：
  1. 启动代理服务
  2. 检查数据库状态字段
  3. 检查实际进程状态
  4. 验证两者一致
  5. 停止代理服务
  6. 再次验证一致性
- **预期结果**：
  - 数据库状态与实际状态一致
  - 状态更新及时

#### 3.3.3 事务处理测试

**测试用例 TC-INT-023：代理服务创建事务**

- **测试步骤**：
  1. 开始事务
  2. 创建代理服务记录
  3. 创建Host配置记录
  4. 如果任何步骤失败，回滚事务
  5. 提交事务
- **预期结果**：
  - 事务正确管理
  - 失败时正确回滚
  - 成功时正确提交
  - 数据一致性保持

**测试用例 TC-INT-024：并发操作数据一致性**

- **测试步骤**：
  1. 两个用户同时创建代理服务
  2. 验证端口分配不冲突
  3. 验证数据库记录正确创建
- **预期结果**：
  - 并发操作正确处理
  - 端口分配不冲突
  - 数据正确保存

---

## 四、性能测试

### 4.1 API响应时间测试

**测试目标：** 验证API接口的响应时间是否满足性能要求

**性能指标：**

- **简单查询API**（如获取列表）：响应时间 < 200ms
- **复杂查询API**（如关联查询）：响应时间 < 500ms
- **创建操作API**（如创建代理服务）：响应时间 < 5s（包含SSH操作）
- **更新操作API**：响应时间 < 1s
- **删除操作API**：响应时间 < 500ms

**测试用例 TC-PERF-001：用户认证API响应时间**

- **测试步骤**：
  1. 使用Apache Bench测试登录API
  2. 命令：`ab -n 100 -c 10 -p login.json -T application/json http://t58:3100/api/v1/auth/login`
  3. 记录平均响应时间、最小响应时间、最大响应时间
- **预期结果**：
  - 平均响应时间 < 200ms
  - 95%的请求响应时间 < 300ms
  - 无请求失败

**测试用例 TC-PERF-002：代理服务列表API响应时间**

- **前置条件**：数据库中已存在100条代理服务记录
- **测试步骤**：
  1. 测试获取代理服务列表API
  2. 记录响应时间
- **预期结果**：
  - 响应时间 < 500ms
  - 分页功能正常工作

**测试用例 TC-PERF-003：创建代理服务API响应时间**

- **测试步骤**：
  1. 测试创建代理服务API（包含SSH操作）
  2. 记录完整响应时间
- **预期结果**：
  - 响应时间 < 5s（包含SSH连接和密钥推送）
  - 日志实时输出，用户体验良好

**测试用例 TC-PERF-004：PAC配置生成API响应时间**

- **前置条件**：已存在多个Host配置
- **测试步骤**：
  1. 测试PAC配置生成API
  2. 记录响应时间
- **预期结果**：
  - 响应时间 < 200ms
  - 配置缓存机制有效（第二次请求更快）

**测试工具和方法：**

1. **Apache Bench (ab)**
   ```bash
   # 测试GET请求
   ab -n 1000 -c 10 http://t58:3100/api/v1/proxy-services
   
   # 测试POST请求
   ab -n 100 -c 10 -p data.json -T application/json http://t58:3100/api/v1/auth/login
   ```

2. **curl时间测量**
   ```bash
   curl -w "@curl-format.txt" -o /dev/null -s http://t58:3100/api/v1/proxy-services
   ```

3. **Chrome DevTools Network面板**
   - 查看每个API请求的响应时间
   - 分析请求和响应大小

### 4.2 页面加载性能测试

**测试目标：** 验证前端页面的加载速度和渲染性能

**性能指标：**

- **首屏加载时间**：< 2s
- **页面完全加载时间**：< 3s
- **Time to Interactive (TTI)**：< 3.5s
- **Largest Contentful Paint (LCP)**：< 2.5s
- **First Input Delay (FID)**：< 100ms

**测试用例 TC-PERF-005：登录页面加载性能**

- **测试步骤**：
  1. 清除浏览器缓存
  2. 打开Chrome DevTools Performance面板
  3. 访问登录页面
  4. 记录页面加载指标
- **预期结果**：
  - 首屏加载时间 < 1s
  - 页面完全加载时间 < 2s
  - 资源文件大小合理

**测试用例 TC-PERF-006：主页面（Dashboard）加载性能**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问主页面
  2. 记录页面加载时间
  3. 记录API请求时间
  4. 记录数据渲染时间
- **预期结果**：
  - 首屏加载时间 < 2s
   - API请求完成时间 < 500ms
   - 数据渲染时间 < 500ms
   - 页面交互流畅

**测试用例 TC-PERF-007：代理服务列表渲染性能**

- **前置条件**：已存在大量代理服务（50+）
- **测试步骤**：
  1. 访问代理服务列表页面
  2. 记录列表渲染时间
  3. 测试滚动性能
- **预期结果**：
  - 列表渲染时间 < 1s
  - 滚动流畅，无卡顿
  - 虚拟滚动或分页机制有效

**测试用例 TC-PERF-008：PAC配置预览加载性能**

- **测试步骤**：
  1. 打开PAC配置预览标签页
  2. 记录代码高亮渲染时间
  3. 测试大配置文件的显示性能
- **预期结果**：
  - 代码高亮渲染时间 < 500ms
  - 大配置文件可以正常显示
  - 滚动流畅

**测试工具和方法：**

1. **Chrome DevTools Performance面板**
   - 录制页面加载过程
   - 分析性能瓶颈
   - 查看FPS、内存使用等指标

2. **Lighthouse**
   ```bash
   # 使用Chrome DevTools Lighthouse标签页
   # 或使用命令行工具
   lighthouse http://localhost:5173 --view
   ```

3. **WebPageTest**
   - 在线工具：https://www.webpagetest.org/
   - 测试页面加载性能

4. **Chrome DevTools Network面板**
   - 查看资源加载时间
   - 分析资源大小
   - 检查缓存策略

### 4.3 并发测试

**测试目标：** 验证系统在并发请求下的稳定性和性能

**性能指标：**

- **并发用户数**：支持至少10个并发用户
- **请求成功率**：> 99%
- **响应时间**：在并发情况下，响应时间增加 < 50%
- **系统稳定性**：无崩溃、无内存泄漏

**测试用例 TC-PERF-009：并发登录测试**

- **测试步骤**：
  1. 使用Apache Bench模拟10个并发用户登录
  2. 命令：`ab -n 100 -c 10 -p login.json -T application/json http://t58:3100/api/v1/auth/login`
  3. 记录请求成功率、平均响应时间
- **预期结果**：
  - 请求成功率 > 99%
  - 平均响应时间 < 300ms
  - 无Session冲突

**测试用例 TC-PERF-010：并发创建代理服务测试**

- **测试步骤**：
  1. 模拟5个用户同时创建代理服务
  2. 使用不同的跳板服务器
  3. 记录创建成功率和响应时间
- **预期结果**：
  - 所有请求都能成功处理
  - 端口分配不冲突
  - 数据库操作正确
  - 响应时间合理

**测试用例 TC-PERF-011：并发查询测试**

- **测试步骤**：
  1. 模拟20个并发用户查询代理服务列表
  2. 记录响应时间和数据库连接数
- **预期结果**：
  - 所有请求成功
  - 响应时间 < 500ms
  - 数据库连接数在合理范围内
  - 无连接泄漏

**测试用例 TC-PERF-012：混合负载测试**

- **测试步骤**：
  1. 模拟真实场景的混合负载：
     - 30% 查询请求
     - 20% 创建请求
     - 30% 更新请求
     - 20% 删除请求
  2. 持续运行5分钟
  3. 监控系统资源使用（CPU、内存）
- **预期结果**：
  - 系统稳定运行
  - CPU使用率 < 80%
  - 内存使用稳定，无泄漏
  - 请求成功率 > 99%

**测试工具和方法：**

1. **Apache Bench (ab)**
   ```bash
   # 并发测试
   ab -n 1000 -c 10 http://t58:3100/api/v1/proxy-services
   ```

2. **k6**（推荐用于复杂场景）
   ```javascript
   import http from 'k6/http';
   import { check } from 'k6';
   
   export let options = {
     vus: 10,
     duration: '30s',
   };
   
   export default function() {
     let res = http.get('http://t58:3100/api/v1/proxy-services');
     check(res, {
       'status is 200': (r) => r.status === 200,
       'response time < 500ms': (r) => r.timings.duration < 500,
     });
   }
   ```

3. **Artillery**（可选）
   ```bash
   npm install -g artillery
   artillery quick --count 10 --num 100 http://t58:3100/api/v1/proxy-services
   ```

**性能监控指标：**

- **API响应时间分布**：P50、P95、P99
- **请求成功率**：成功请求数 / 总请求数
- **错误率**：错误请求数 / 总请求数
- **吞吐量**：每秒处理的请求数（QPS）
- **系统资源**：CPU使用率、内存使用率、磁盘I/O、网络I/O
- **数据库性能**：查询时间、连接数、锁等待时间

**性能优化建议：**

1. **API优化**
   - 使用数据库索引优化查询
   - 实现API响应缓存
   - 使用连接池管理数据库连接

2. **前端优化**
   - 代码分割和懒加载
   - 资源压缩和CDN
   - 图片优化
   - 使用虚拟滚动处理大列表

3. **数据库优化**
   - 添加必要的索引
   - 优化查询语句
   - 使用连接池

4. **代理服务优化**
   - 异步处理SSH操作
   - 实现操作队列
   - 优化进程管理

---

## 五、安全测试

### 5.1 认证安全测试

#### 5.1.1 密码加密测试

**测试用例 TC-SEC-001：密码存储加密验证**

- **测试步骤**：
  1. 创建新用户，密码为`Test123456`
  2. 查询数据库中的password_hash字段
  3. 验证密码不是明文存储
  4. 验证密码是bcrypt哈希格式
  5. 使用bcrypt.compare验证密码正确性
- **预期结果**：
  - 密码不是明文存储
  - 密码是bcrypt哈希格式（以$2a$、$2b$或$2y$开头）
  - 相同密码的哈希值不同（salt机制）
  - 密码验证功能正常

**测试用例 TC-SEC-002：密码强度验证**

- **测试步骤**：
  1. 尝试注册弱密码：`123456`
  2. 尝试注册短密码：`abc123`
  3. 尝试注册符合要求的密码：`Test123456`
- **预期结果**：
  - 弱密码被拒绝
  - 短密码被拒绝
  - 符合要求的密码被接受
  - 前端显示密码强度提示

**测试用例 TC-SEC-003：密码传输安全**

- **测试步骤**：
  1. 使用抓包工具（如Wireshark）监控网络请求
  2. 提交登录请求
  3. 检查请求体中的密码是否加密
- **预期结果**：
  - 密码在传输过程中应使用HTTPS加密（生产环境）
  - 开发环境可以使用HTTP，但应提醒用户生产环境使用HTTPS
  - 密码不应出现在URL参数中

#### 5.1.2 Session安全测试

**测试用例 TC-SEC-004：Session Cookie安全属性**

- **测试步骤**：
  1. 用户登录
  2. 检查浏览器中的Session Cookie属性
  3. 验证HttpOnly、Secure、SameSite属性
- **预期结果**：
  - HttpOnly属性为true（防止JavaScript访问）
  - Secure属性在生产环境为true（HTTPS only）
  - SameSite属性设置合理（防止CSRF）
  - Cookie名称不是默认值（如connect.sid）

**测试用例 TC-SEC-005：Session固定攻击防护**

- **测试步骤**：
  1. 获取登录前的Session ID
  2. 用户登录
  3. 获取登录后的Session ID
  4. 验证Session ID是否变化
- **预期结果**：
  - 登录后Session ID重新生成
  - 旧的Session ID失效
  - 防止Session固定攻击

**测试用例 TC-SEC-006：Session过期时间**

- **测试步骤**：
  1. 用户登录
  2. 记录Session创建时间
  3. 等待Session过期时间（24小时）
  4. 尝试访问需要认证的API
- **预期结果**：
  - Session在24小时后过期
  - 过期后访问API返回401
  - 前端正确处理Session过期

**测试用例 TC-SEC-007：Session劫持防护**

- **测试步骤**：
  1. 用户A登录，获取Session Cookie
  2. 用户B尝试使用用户A的Session Cookie访问API
  3. 检查是否能够访问
- **预期结果**：
  - 如果Session绑定IP或其他标识，用户B无法使用
  - 或者Session验证失败
  - 系统记录异常访问日志

#### 5.1.3 认证绕过测试

**测试用例 TC-SEC-008：未认证访问受保护API**

- **测试步骤**：
  1. 不登录，直接访问需要认证的API
  2. 例如：`GET /api/v1/proxy-services`
- **预期结果**：
  - 返回401 Unauthorized错误
  - 错误信息："未登录"
  - 不返回任何数据

**测试用例 TC-SEC-009：伪造Session Cookie**

- **测试步骤**：
  1. 伪造一个Session Cookie
  2. 尝试使用伪造的Cookie访问API
- **预期结果**：
  - 认证失败
  - 返回401错误
  - 系统记录异常访问

**测试用例 TC-SEC-010：SQL注入绕过认证**

- **测试步骤**：
  1. 在登录表单中输入SQL注入payload
  2. 例如：用户名输入`admin' OR '1'='1`
  3. 提交登录请求
- **预期结果**：
  - 登录失败
  - 使用参数化查询，SQL注入无效
  - 返回正常的错误信息

### 5.2 输入验证测试

#### 5.2.1 参数验证测试

**测试用例 TC-SEC-011：用户名格式验证**

- **测试步骤**：
  1. 尝试注册包含特殊字符的用户名：`user<script>`
  2. 尝试注册过长的用户名：`a` * 100
  3. 尝试注册空用户名
- **预期结果**：
  - 特殊字符被拒绝或转义
  - 过长用户名被拒绝
  - 空用户名被拒绝
  - 返回适当的验证错误

**测试用例 TC-SEC-012：邮箱格式验证**

- **测试步骤**：
  1. 尝试输入无效邮箱：`invalid-email`
  2. 尝试输入SQL注入payload：`test@example.com'; DROP TABLE users;--`
  3. 尝试输入XSS payload：`test<script>alert(1)</script>@example.com`
- **预期结果**：
  - 无效邮箱被拒绝
  - SQL注入无效（参数化查询）
  - XSS payload被转义或拒绝
  - 返回验证错误

**测试用例 TC-SEC-013：Host域名验证**

- **测试步骤**：
  1. 尝试输入无效域名：`invalid..domain`
  2. 尝试输入包含路径的域名：`google.com/path`
  3. 尝试输入包含协议的域名：`http://google.com`
  4. 尝试输入SQL注入payload
- **预期结果**：
  - 无效域名被拒绝
  - 路径和协议被过滤或拒绝
  - SQL注入无效
  - 只接受有效的域名格式

**测试用例 TC-SEC-014：跳板服务器地址验证**

- **测试步骤**：
  1. 尝试输入无效IP：`999.999.999.999`
  2. 尝试输入包含命令注入的地址：`192.168.1.1; rm -rf /`
  3. 尝试输入XSS payload
- **预期结果**：
  - 无效IP被拒绝
  - 命令注入无效（参数化处理）
  - XSS payload被转义
  - 只接受有效的IP或域名

#### 5.2.2 SQL注入防护测试

**测试用例 TC-SEC-015：登录SQL注入测试**

- **测试步骤**：
  1. 用户名输入：`admin' OR '1'='1'--`
  2. 密码输入：任意值
  3. 提交登录请求
- **预期结果**：
  - 登录失败
  - 使用参数化查询，SQL注入无效
  - 返回正常的错误信息

**测试用例 TC-SEC-016：查询参数SQL注入测试**

- **测试步骤**：
  1. 在API查询参数中输入SQL注入payload
  2. 例如：`GET /api/v1/proxy-services?id=1' OR '1'='1`
  3. 提交请求
- **预期结果**：
  - SQL注入无效
  - 使用参数化查询
  - 返回正常结果或错误

**测试用例 TC-SEC-017：数据库操作SQL注入测试**

- **测试步骤**：
  1. 在创建代理服务的名称字段输入：`test'; DROP TABLE proxy_services;--`
  2. 提交创建请求
- **预期结果**：
  - SQL注入无效
  - 使用参数化查询
  - 数据正确保存
  - 表结构未被破坏

**测试工具：**

- **SQLMap**（可选，用于自动化SQL注入测试）
- **手动测试**：使用常见的SQL注入payload

#### 5.2.3 XSS防护测试

**测试用例 TC-SEC-018：存储型XSS测试**

- **测试步骤**：
  1. 在代理服务名称中输入：`<script>alert('XSS')</script>`
  2. 创建代理服务
  3. 查看代理服务列表页面
  4. 检查脚本是否执行
- **预期结果**：
  - 脚本被转义或过滤
  - 页面显示转义后的文本，不执行脚本
  - 使用Vue的文本插值自动转义

**测试用例 TC-SEC-019：反射型XSS测试**

- **测试步骤**：
  1. 在API查询参数中输入：`?name=<script>alert('XSS')</script>`
  2. 检查响应中是否包含未转义的脚本
- **预期结果**：
  - 脚本被转义
  - 响应中不包含可执行的脚本
  - 使用适当的转义机制

**测试用例 TC-SEC-020：DOM型XSS测试**

- **测试步骤**：
  1. 检查前端代码中是否有直接操作DOM的地方
  2. 尝试注入恶意脚本
  3. 检查是否执行
- **预期结果**：
  - 使用Vue的安全机制
  - 避免使用v-html（除非必要且已转义）
  - DOM操作安全

**测试用例 TC-SEC-021：Host配置XSS测试**

- **测试步骤**：
  1. 在Host配置中输入：`<script>alert('XSS')</script>.com`
  2. 保存配置
  3. 查看Host配置列表
- **预期结果**：
  - 脚本被转义或过滤
  - 只接受有效的域名格式
  - 页面安全显示

**XSS防护措施验证：**

- **Content Security Policy (CSP)**：检查是否设置了CSP头
- **输入转义**：验证所有用户输入都被转义
- **输出编码**：验证输出到页面的内容都被编码
- **Vue安全机制**：使用Vue的文本插值（{{ }}）自动转义

### 5.3 权限控制测试

**测试用例 TC-SEC-022：未登录用户权限测试**

- **测试步骤**：
  1. 不登录，尝试访问以下API：
     - `GET /api/v1/proxy-services`
     - `POST /api/v1/proxy-services`
     - `PUT /api/v1/system-configs/register_enabled`
  2. 检查返回结果
- **预期结果**：
  - 所有需要认证的API返回401
  - 错误信息："未登录"
  - 不返回任何数据

**测试用例 TC-SEC-023：已登录用户权限测试**

- **前置条件**：用户已登录
- **测试步骤**：
  1. 访问所有管理API
  2. 验证权限
- **预期结果**：
  - 所有用户都有完全的管理权限（根据需求文档）
  - 可以创建、删除、管理代理服务
   - 可以管理Host配置
   - 可以管理系统配置

**测试用例 TC-SEC-024：Session失效后权限测试**

- **测试步骤**：
  1. 用户登录
  2. 手动清除Session（或等待过期）
  3. 尝试访问需要认证的API
- **预期结果**：
  - 返回401错误
  - 前端正确处理，跳转到登录页
  - 无法访问受保护资源

**测试用例 TC-SEC-025：跨用户数据访问测试**

- **前置条件**：存在多个用户
- **测试步骤**：
  1. 用户A登录，创建代理服务
  2. 用户B登录
  3. 用户B尝试访问用户A创建的代理服务
- **预期结果**：
  - 根据需求，所有用户共享代理服务配置
  - 用户B可以访问用户A创建的代理服务
  - 符合需求："所有用户都有完全的配置权限"

**安全测试工具：**

1. **OWASP ZAP**（可选）
   - 自动化安全扫描工具
   - 检测常见安全漏洞

2. **Burp Suite**（可选）
   - Web应用安全测试工具
   - 拦截和修改HTTP请求

3. **手动测试**
   - 使用浏览器开发者工具
   - 使用curl或Postman
   - 使用SQL注入和XSS payload清单

**安全测试检查清单：**

- [ ] 密码加密存储（bcrypt）
- [ ] Session Cookie安全属性（HttpOnly、Secure、SameSite）
- [ ] Session固定攻击防护
- [ ] 输入验证和转义
- [ ] SQL注入防护（参数化查询）
- [ ] XSS防护（输入转义、输出编码）
- [ ] CSRF防护（SameSite Cookie）
- [ ] 认证绕过防护
- [ ] 权限控制正确
- [ ] 错误信息不泄露敏感信息
- [ ] 日志记录安全事件

---

## 六、UI/UX测试

### 6.1 界面布局测试

#### 6.1.1 整体布局测试

**测试用例 TC-UI-001：三栏布局结构**

- **测试步骤**：
  1. 访问主页面（Dashboard）
  2. 检查页面布局结构：
     - 顶部导航栏（高度60px）
     - 左侧边栏（宽度150px）
     - 主内容区（自适应宽度）
  3. 验证各区域位置和尺寸
- **预期结果**：
  - 布局结构符合UI设计文档
  - 各区域位置正确
  - 尺寸符合设计要求
  - 使用Element Plus Container布局组件

**测试用例 TC-UI-002：顶部导航栏布局**

- **测试步骤**：
  1. 检查顶部导航栏内容：
     - 左侧标题："家庭网络"
     - 右侧链接：GitHub、Support、Discord
  2. 验证链接位置和样式
- **预期结果**：
  - 标题位置：左上角（x: 90px, y: 140px）
  - 链接位置正确
  - 字体大小13px
  - 链接可点击，打开新标签页

**测试用例 TC-UI-003：左侧边栏布局**

- **测试步骤**：
  1. 检查左侧边栏内容：
     - Socks代理菜单项
     - 其他模块 - 占位菜单项
     - 用户信息菜单
     - 系统配置菜单
     - 注销功能
  2. 验证菜单项位置和样式
- **预期结果**：
  - 菜单项位置正确
  - 字体大小13px
  - 激活状态高亮显示
  - 占位功能显示为灰色（#B3B3B3）

**测试用例 TC-UI-004：主内容区布局**

- **测试步骤**：
  1. 检查主内容区布局：
     - 标题栏（高度40px）
     - 代理配置卡片区域
     - 标签页区域
     - PAC配置预览区域
  2. 验证各区域位置和尺寸
- **预期结果**：
  - 标题栏位置正确
  - 代理配置卡片位置：x: 240px, y: 241px，尺寸270x140px
  - 标签页区域位置正确
  - PAC预览区域位置：x: 530px, y: 280px，尺寸500x353px

#### 6.1.2 组件布局测试

**测试用例 TC-UI-005：代理配置卡片布局**

- **测试步骤**：
  1. 检查代理配置卡片内容：
     - 配置名称（左上角）
     - 状态显示（右上角）
     - 代理服务信息（中部）
     - Host配置信息（下部）
     - 操作按钮（V按钮、...按钮）
  2. 验证各元素位置和样式
- **预期结果**：
  - 卡片尺寸270x140px
  - 各元素位置正确
  - 字体大小13px
  - 状态使用颜色标签显示（绿色=运行中，灰色=已停止，红色=错误）

**测试用例 TC-UI-006：标签页布局**

- **测试步骤**：
  1. 检查标签页系统：
     - Host配置标签页格式：`Host配置 - {配置名称}    x`
     - PAC配置预览标签页格式：`PAC配置预览`（无关闭按钮）
  2. 验证标签页位置和样式
- **预期结果**：
  - 标签页水平排列
  - Host配置标签页可关闭（有x按钮）
  - PAC配置预览标签页不可关闭（无x按钮）
  - 激活状态高亮显示
  - 标签页高度30px

**测试用例 TC-UI-007：PAC配置预览区域布局**

- **测试步骤**：
  1. 检查PAC配置预览区域：
     - 代码显示区域
     - 语法高亮
     - 滚动功能
  2. 验证布局和样式
- **预期结果**：
  - 代码区域使用等宽字体
  - JSON语法高亮正确
  - 支持垂直滚动
  - 背景色为代码编辑器样式（浅灰色）

### 6.2 交互功能测试

#### 6.2.1 用户操作流程测试

**测试用例 TC-UI-008：创建代理服务完整流程**

- **测试步骤**：
  1. 点击"+ 添加新配置"按钮
  2. 验证弹窗打开
  3. 填写代理服务表单
  4. 观察日志窗口展开
  5. 点击创建按钮
  6. 观察日志实时显示
  7. 验证创建成功后弹窗关闭
  8. 验证代理服务列表刷新
- **预期结果**：
  - 弹窗正确打开
  - 表单交互流畅
  - 日志窗口实时显示操作过程
  - 创建成功后状态正确更新
  - 用户体验良好

**测试用例 TC-UI-009：Host配置编辑流程**

- **测试步骤**：
  1. 点击代理配置卡片中的Host配置区域（"google.com, youtube.com.."）
  2. 验证打开"Host配置 - {配置名称}"标签页
  3. 在标签页中编辑Host列表
  4. 添加新Host
  5. 删除Host
  6. 点击保存按钮
  7. 验证PAC配置预览自动更新
- **预期结果**：
  - 点击Host配置区域正确打开标签页
  - Host编辑界面正常
  - 保存后配置正确更新
  - PAC预览实时更新

**测试用例 TC-UI-010：代理服务操作流程**

- **测试步骤**：
  1. 点击"V"按钮
  2. 验证弹出菜单显示（停止/启动、删除代理服务）
  3. 点击停止/启动
  4. 验证状态更新
  5. 点击"..."按钮
  6. 验证显示代理服务选择菜单
  7. 选择代理服务或新建代理服务
- **预期结果**：
  - 菜单正确显示
  - 操作执行成功
  - 状态实时更新
  - 只有一个代理服务时不显示选择菜单

#### 6.2.2 表单交互测试

**测试用例 TC-UI-011：代理服务创建表单交互**

- **测试步骤**：
  1. 打开创建代理服务弹窗
  2. 测试表单验证：
     - 必填字段验证
     - 格式验证（IP地址、端口范围）
     - Host格式验证
  3. 测试一键导入默认Host功能
  4. 测试密码输入框（type="password"）
  5. 测试安全提示显示
- **预期结果**：
  - 表单验证及时、准确
  - 错误提示清晰
  - 一键导入功能正常
  - 密码输入安全
  - 安全提示显示正确

**测试用例 TC-UI-012：Host配置表单交互**

- **测试步骤**：
  1. 打开Host配置标签页
  2. 测试添加Host：
     - 输入域名
     - 回车添加
     - 点击添加按钮
  3. 测试删除Host（点击标签的x）
  4. 测试Host冲突提示
  5. 测试保存按钮
- **预期结果**：
  - Host添加功能正常
  - Host删除功能正常
  - 冲突检测及时提示
  - 保存功能正常

#### 6.2.3 弹窗交互测试

**测试用例 TC-UI-013：代理服务弹窗交互**

- **测试步骤**：
  1. 打开创建/编辑代理服务弹窗
  2. 测试弹窗大小和位置（居中显示）
  3. 测试遮罩层（点击遮罩关闭弹窗）
  4. 测试关闭按钮
  5. 测试ESC键关闭
  6. 测试表单提交后弹窗关闭
- **预期结果**：
  - 弹窗大小适中（PC端800-1000px宽度）
  - 弹窗居中显示
  - 遮罩层半透明
  - 关闭功能正常
  - 交互流畅

**测试用例 TC-UI-014：日志窗口交互**

- **测试步骤**：
  1. 创建代理服务时观察日志窗口
  2. 测试日志实时更新
  3. 测试自动滚动到底部
  4. 测试手动滚动查看历史日志
  5. 测试日志窗口折叠/展开
- **预期结果**：
  - 日志实时追加显示
  - 自动滚动到底部（显示最新日志）
  - 支持手动滚动
  - 折叠/展开功能正常
  - 日志格式清晰（时间戳、日志级别、内容）

#### 6.2.4 标签页交互测试

**测试用例 TC-UI-015：标签页打开和关闭**

- **测试步骤**：
  1. 点击代理配置卡片中的Host配置区域
  2. 验证打开Host配置标签页
  3. 点击标签页的x按钮关闭
  4. 验证标签页关闭
  5. 测试打开多个Host配置标签页
  6. 测试标签页切换
- **预期结果**：
  - 标签页正确打开
  - 标签页正确关闭
  - 多个标签页可以同时存在
  - 标签页切换流畅
  - 关闭最后一个Host配置标签后，自动切换到PAC配置预览

**测试用例 TC-UI-016：PAC配置预览标签页**

- **测试步骤**：
  1. 验证PAC配置预览标签页始终存在
  2. 验证标签页无关闭按钮
  3. 测试标签页切换
  4. 测试PAC配置实时更新
- **预期结果**：
  - PAC配置预览标签页始终可用
  - 标签页不可关闭
  - 切换流畅
  - 配置实时更新

### 6.3 响应式设计测试

#### 6.3.1 桌面端测试

**测试用例 TC-UI-017：桌面端布局（≥1200px）**

- **测试步骤**：
  1. 设置浏览器窗口宽度≥1200px
  2. 检查整体布局
  3. 验证各区域正常显示
  4. 验证代理配置卡片和PAC预览并排显示
- **预期结果**：
  - 完整布局正常显示
  - 左侧边栏固定宽度150px
  - 代理配置卡片和PAC预览并排显示
  - 所有功能正常

#### 6.3.2 平板端测试

**测试用例 TC-UI-018：平板端布局（768px-1199px）**

- **测试步骤**：
  1. 设置浏览器窗口宽度768px-1199px
  2. 检查布局适配
  3. 测试左侧边栏折叠功能
  4. 测试代理配置卡片和PAC预览垂直堆叠
  5. 测试标签页横向滚动
- **预期结果**：
  - 左侧边栏可折叠
  - 代理配置卡片和PAC预览可垂直堆叠
  - 标签页支持横向滚动
  - 字体大小适当缩小（-2px）
  - 功能正常

#### 6.3.3 移动端测试

**测试用例 TC-UI-019：移动端布局（<768px）**

- **测试步骤**：
  1. 设置浏览器窗口宽度<768px
  2. 检查布局适配
  3. 测试左侧边栏改为抽屉式（Drawer）
  4. 测试代理配置卡片全宽显示
  5. 测试PAC预览区全宽显示
  6. 测试弹窗全屏显示
- **预期结果**：
  - 左侧边栏改为抽屉式，默认隐藏
  - 代理配置卡片全宽显示，垂直堆叠
  - PAC预览区全宽显示
  - 弹窗全屏显示
  - 字体大小进一步缩小（-4px）
  - 触摸目标足够大
  - 功能正常

### 6.4 浏览器兼容性测试

**测试用例 TC-UI-020：Chrome浏览器测试**

- **测试步骤**：
  1. 使用Chrome 90+浏览器
  2. 测试所有功能
  3. 检查样式显示
  4. 检查JavaScript功能
- **预期结果**：
  - 所有功能正常
  - 样式正确显示
  - JavaScript功能正常
  - 性能良好

**测试用例 TC-UI-021：Firefox浏览器测试**

- **测试步骤**：
  1. 使用Firefox 88+浏览器
  2. 测试所有功能
  3. 检查样式显示
  4. 检查JavaScript功能
- **预期结果**：
  - 所有功能正常
  - 样式正确显示
  - JavaScript功能正常
  - 与Chrome表现一致

**测试用例 TC-UI-022：Safari浏览器测试**

- **测试步骤**：
  1. 使用Safari 14+浏览器
  2. 测试所有功能
  3. 检查样式显示
  4. 检查JavaScript功能
- **预期结果**：
  - 所有功能正常
  - 样式正确显示
  - JavaScript功能正常
  - 与Chrome表现一致

**测试用例 TC-UI-023：Edge浏览器测试**

- **测试步骤**：
  1. 使用Edge 90+浏览器
  2. 测试所有功能
  3. 检查样式显示
  4. 检查JavaScript功能
- **预期结果**：
  - 所有功能正常
  - 样式正确显示
  - JavaScript功能正常
  - 与Chrome表现一致（基于Chromium）

**UI风格验证：**

- **Material Design规范**：验证是否符合Material Design原则
- **平面风格**：验证不使用阴影效果
- **颜色规范**：验证颜色使用符合设计文档
- **字体规范**：验证字体大小和样式符合设计文档
- **间距规范**：验证间距符合设计文档

**UI测试检查清单：**

- [ ] 整体布局符合设计文档
- [ ] 组件布局正确
- [ ] 交互功能流畅
- [ ] 表单验证及时
- [ ] 弹窗交互正常
- [ ] 标签页功能正常
- [ ] 响应式设计适配良好
- [ ] 主流浏览器兼容
- [ ] UI风格符合Material Design
- [ ] 颜色、字体、间距符合规范

---

## 七、边界和异常测试

### 7.1 边界值测试

**测试用例 TC-BOUND-001：用户名长度边界值**

- **测试步骤**：
  1. 测试最小长度：2个字符（应失败）
  2. 测试最小有效长度：3个字符（应成功）
  3. 测试最大有效长度：20个字符（应成功）
  4. 测试超过最大长度：21个字符（应失败）
- **预期结果**：
  - 长度验证正确
  - 边界值处理正确
  - 错误提示清晰

**测试用例 TC-BOUND-002：密码长度边界值**

- **测试步骤**：
  1. 测试最小长度：7个字符（应失败）
  2. 测试最小有效长度：8个字符（应成功）
  3. 测试较长密码：50个字符（应成功）
  4. 测试超长密码：1000个字符（应失败或截断）
- **预期结果**：
  - 长度验证正确
  - 边界值处理正确
  - 超长密码有适当处理

**测试用例 TC-BOUND-003：端口号边界值**

- **测试步骤**：
  1. 测试最小端口：1（应失败，SSH默认22）
  2. 测试有效端口：22（应成功）
  3. 测试最大端口：65535（应成功）
  4. 测试超过最大端口：65536（应失败）
  5. 测试代理端口范围：11081-11082（应成功）
  6. 测试超出代理端口范围：1079或1083（应失败）
- **预期结果**：
  - 端口范围验证正确
  - 边界值处理正确
  - 错误提示清晰

**测试用例 TC-BOUND-004：Host列表边界值**

- **测试步骤**：
  1. 测试空Host列表（应失败）
  2. 测试单个Host（应成功）
  3. 测试多个Host：10个（应成功）
  4. 测试大量Host：100个（应成功，但需验证性能）
  5. 测试Host名称长度：超长域名（应失败或截断）
- **预期结果**：
  - Host列表验证正确
  - 边界值处理正确
  - 大量Host时性能可接受

**测试用例 TC-BOUND-005：代理服务数量边界值**

- **测试步骤**：
  1. 测试创建第一个代理服务（应成功）
  2. 测试创建第二个代理服务（应成功）
  3. 测试创建第二个代理服务（应成功，使用最后一个端口11082）
  4. 测试创建第三个代理服务（应失败，端口已用完）
- **预期结果**：
  - 端口分配正确
  - 达到上限时正确提示
  - 错误信息清晰

**测试用例 TC-BOUND-006：分页边界值**

- **测试步骤**：
  1. 测试第一页：`page=1`（应成功）
  2. 测试最后一页（应成功）
  3. 测试超出范围的页码：`page=99999`（应返回空列表或错误）
  4. 测试pageSize边界值：1、10、100、1000
- **预期结果**：
  - 分页逻辑正确
  - 边界值处理正确
  - 超出范围有适当处理

### 7.2 异常场景测试

**测试用例 TC-EXCEPT-001：网络异常场景**

- **测试步骤**：
  1. 模拟网络断开
  2. 尝试调用API
  3. 恢复网络连接
  4. 验证系统恢复
- **预期结果**：
  - 网络断开时显示错误提示
  - 错误信息清晰
  - 网络恢复后系统正常工作
  - 无数据丢失

**测试用例 TC-EXCEPT-002：跳板服务器不可达**

- **测试步骤**：
  1. 使用不可达的跳板服务器地址创建代理服务
  2. 观察错误处理
  3. 验证系统状态
- **预期结果**：
  - 连接超时或失败
  - 错误信息清晰："无法连接到跳板服务器"
  - 未创建代理服务记录
  - 系统状态一致

**测试用例 TC-EXCEPT-003：跳板服务器SSH服务停止**

- **测试步骤**：
  1. 停止跳板服务器的SSH服务
  2. 尝试创建代理服务
  3. 观察错误处理
- **预期结果**：
  - 连接失败
  - 错误信息："SSH服务不可用"或"连接被拒绝"
  - 未创建代理服务记录

**测试用例 TC-EXCEPT-004：autossh进程异常退出**

- **测试步骤**：
  1. 创建并启动代理服务
  2. 手动杀死autossh进程
  3. 等待状态检查（30秒）
  4. 验证状态更新
- **预期结果**：
  - 进程异常退出被检测到
  - 数据库状态更新为stopped或error
  - 前端状态显示更新
  - 可以重新启动

**测试用例 TC-EXCEPT-005：数据库文件损坏**

- **测试步骤**：
  1. 模拟数据库文件损坏
  2. 尝试访问系统
  3. 观察错误处理
- **预期结果**：
  - 错误被正确捕获
  - 错误信息清晰
  - 系统不会崩溃
  - 提供恢复建议

**测试用例 TC-EXCEPT-006：磁盘空间不足**

- **测试步骤**：
  1. 模拟磁盘空间不足
  2. 尝试创建代理服务（需要生成SSH密钥）
  3. 观察错误处理
- **预期结果**：
  - 错误被正确捕获
  - 错误信息："磁盘空间不足"
  - 未创建代理服务记录
  - 系统状态一致

**测试用例 TC-EXCEPT-007：并发创建代理服务**

- **测试步骤**：
  1. 同时创建多个代理服务
  2. 验证端口分配不冲突
  3. 验证所有创建操作成功
- **预期结果**：
  - 端口分配不冲突
  - 所有创建操作成功
  - 数据库记录正确
  - 无数据竞争问题

**测试用例 TC-EXCEPT-008：删除正在运行的代理服务**

- **测试步骤**：
  1. 启动代理服务
  2. 删除代理服务
  3. 验证进程停止
  4. 验证资源清理
- **预期结果**：
  - 进程正确停止
   - SSH密钥文件删除
   - 数据库记录删除
   - Host配置级联删除
   - 资源完全清理

**测试用例 TC-EXCEPT-009：Session过期处理**

- **测试步骤**：
  1. 用户登录
  2. 等待Session过期（或手动清除）
  3. 尝试执行操作
  4. 验证错误处理
- **预期结果**：
  - Session过期被检测
  - 返回401错误
  - 前端跳转到登录页
  - 用户数据不丢失（可重新登录）

**测试用例 TC-EXCEPT-010：数据库连接失败**

- **测试步骤**：
  1. 模拟数据库连接失败
  2. 尝试执行数据库操作
  3. 观察错误处理
- **预期结果**：
  - 错误被正确捕获
  - 错误信息清晰
  - 系统不会崩溃
  - 提供重试机制

### 7.3 错误处理测试

**测试用例 TC-ERROR-001：API错误响应格式**

- **测试步骤**：
  1. 触发各种错误场景
  2. 检查错误响应格式
  3. 验证错误码和错误信息
- **预期结果**：
  - 错误响应格式统一：
    ```json
    {
      "success": false,
      "error": {
        "code": "ERROR_CODE",
        "message": "错误描述"
      }
    }
    ```
  - HTTP状态码正确
  - 错误码有意义
  - 错误信息清晰

**测试用例 TC-ERROR-002：前端错误提示**

- **测试步骤**：
  1. 触发各种错误场景
  2. 检查前端错误提示
  3. 验证错误提示显示
- **预期结果**：
  - 错误提示及时显示
  - 错误信息清晰易懂
  - 使用Element Plus的el-message或el-alert组件
  - 错误提示自动消失或可手动关闭

**测试用例 TC-ERROR-003：表单验证错误提示**

- **测试步骤**：
  1. 提交无效的表单数据
  2. 检查验证错误提示
  3. 验证错误提示位置和样式
- **预期结果**：
  - 验证错误及时显示
  - 错误提示位置正确（字段下方）
  - 错误信息清晰
  - 使用Element Plus的表单验证

**测试用例 TC-ERROR-004：网络错误处理**

- **测试步骤**：
  1. 模拟网络超时
  2. 模拟网络错误
  3. 检查错误处理
- **预期结果**：
  - 网络错误被正确捕获
  - 显示友好的错误提示
  - 提供重试机制
  - 不显示技术细节给用户

**测试用例 TC-ERROR-005：服务器错误处理**

- **测试步骤**：
  1. 模拟服务器500错误
  2. 检查错误处理
  3. 验证错误日志记录
- **预期结果**：
  - 500错误被正确捕获
  - 前端显示友好错误提示
  - 后端记录详细错误日志
  - 不向用户暴露敏感信息

**测试用例 TC-ERROR-006：资源不存在错误**

- **测试步骤**：
  1. 访问不存在的资源ID
  2. 检查404错误处理
- **预期结果**：
  - 返回404 Not Found
  - 错误信息："资源不存在"
  - 前端显示友好提示

**测试用例 TC-ERROR-007：权限不足错误**

- **测试步骤**：
  1. 未登录访问需要认证的API
  2. 检查401错误处理
- **预期结果**：
  - 返回401 Unauthorized
  - 错误信息："未登录"
  - 前端跳转到登录页

**测试用例 TC-ERROR-008：资源冲突错误**

- **测试步骤**：
  1. 创建重复的用户名
  2. 创建冲突的Host配置
  3. 检查409错误处理
- **预期结果**：
  - 返回409 Conflict
  - 错误信息包含冲突详情
  - 前端显示冲突提示

**测试用例 TC-ERROR-009：日志记录错误**

- **测试步骤**：
  1. 触发各种错误场景
  2. 检查后端日志记录
  3. 验证日志格式和内容
- **预期结果**：
  - 所有错误都被记录
  - 日志格式统一
  - 日志包含足够信息用于调试
  - 日志文件正确保存

**测试用例 TC-ERROR-010：用户友好的错误信息**

- **测试步骤**：
  1. 检查各种错误场景的错误信息
  2. 验证错误信息是否用户友好
- **预期结果**：
  - 错误信息清晰易懂
  - 不包含技术细节
  - 提供解决建议（如可能）
  - 使用中文错误信息

**错误处理检查清单：**

- [ ] 所有错误场景都有适当的错误处理
- [ ] 错误响应格式统一
- [ ] HTTP状态码正确
- [ ] 错误信息清晰
- [ ] 前端错误提示友好
- [ ] 后端错误日志完整
- [ ] 不向用户暴露敏感信息
- [ ] 提供重试机制（如适用）
- [ ] 错误不影响系统稳定性

---

## 八、测试用例清单

### 8.1 测试用例表格

**测试用例汇总表**

| 用例编号 | 测试模块 | 测试功能 | 优先级 | 测试类型 | 前置条件 |
|---------|---------|---------|--------|---------|---------|
| TC-AUTH-001 | 用户认证 | 正常注册流程 | P0 | 功能测试 | 注册功能开启 |
| TC-AUTH-002 | 用户认证 | 用户名已存在 | P0 | 功能测试 | 用户已存在 |
| TC-AUTH-003 | 用户认证 | 注册功能已关闭 | P0 | 功能测试 | 注册功能关闭 |
| TC-AUTH-004 | 用户认证 | 参数验证失败 | P0 | 功能测试 | 无 |
| TC-AUTH-005 | 用户认证 | 正常登录流程 | P0 | 功能测试 | 用户已存在 |
| TC-AUTH-006 | 用户认证 | 用户名或密码错误 | P0 | 功能测试 | 无 |
| TC-AUTH-007 | 用户认证 | 用户不存在 | P0 | 功能测试 | 无 |
| TC-AUTH-008 | 用户认证 | 登录后Session有效性 | P0 | 功能测试 | 用户已登录 |
| TC-AUTH-009 | 用户认证 | 正常注销流程 | P0 | 功能测试 | 用户已登录 |
| TC-AUTH-010 | 用户认证 | 未登录时注销 | P1 | 功能测试 | 用户未登录 |
| TC-AUTH-011 | 用户认证 | 获取已登录用户信息 | P0 | 功能测试 | 用户已登录 |
| TC-AUTH-012 | 用户认证 | 未登录时获取用户信息 | P1 | 功能测试 | 用户未登录 |
| TC-USER-001 | 用户管理 | 正常修改密码流程 | P0 | 功能测试 | 用户已登录 |
| TC-USER-002 | 用户管理 | 旧密码错误 | P0 | 功能测试 | 用户已登录 |
| TC-USER-003 | 用户管理 | 新密码格式验证 | P0 | 功能测试 | 用户已登录 |
| TC-USER-004 | 用户管理 | 更新邮箱 | P1 | 功能测试 | 用户已登录 |
| TC-USER-005 | 用户管理 | 邮箱格式验证 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-001 | 代理服务管理 | 正常创建代理服务流程 | P0 | 功能测试 | 用户已登录，跳板服务器可访问 |
| TC-PROXY-002 | 代理服务管理 | SSH连接失败 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-003 | 代理服务管理 | SSH认证失败 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-004 | 代理服务管理 | 端口已占用 | P0 | 功能测试 | 端口已占用 |
| TC-PROXY-005 | 代理服务管理 | 自动创建Host配置 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-006 | 代理服务管理 | 获取代理服务列表 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-007 | 代理服务管理 | 按状态筛选 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-008 | 代理服务管理 | 分页功能 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-009 | 代理服务管理 | 获取存在的代理服务详情 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-010 | 代理服务管理 | 获取不存在的代理服务详情 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-011 | 代理服务管理 | 更新代理服务名称 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-012 | 代理服务管理 | 更新跳板服务器信息 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-013 | 代理服务管理 | 正常删除代理服务 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-014 | 代理服务管理 | 删除不存在的代理服务 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-015 | 代理服务管理 | 启动已停止的代理服务 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-016 | 代理服务管理 | 启动已运行的代理服务 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-017 | 代理服务管理 | 停止运行中的代理服务 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-018 | 代理服务管理 | 停止已停止的代理服务 | P1 | 功能测试 | 用户已登录 |
| TC-PROXY-019 | 代理服务管理 | 获取代理服务状态 | P0 | 功能测试 | 用户已登录 |
| TC-PROXY-020 | 代理服务管理 | 状态实时检查 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-001 | Host配置管理 | 正常创建Host配置 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-002 | Host配置管理 | Host冲突检测 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-003 | Host配置管理 | 代理服务不存在 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-004 | Host配置管理 | 获取Host配置列表 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-005 | Host配置管理 | 按代理服务筛选 | P1 | 功能测试 | 用户已登录 |
| TC-HOST-006 | Host配置管理 | 获取Host配置详情 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-007 | Host配置管理 | 更新Host列表 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-008 | Host配置管理 | 更新后Host冲突检测 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-009 | Host配置管理 | 删除Host配置 | P0 | 功能测试 | 用户已登录 |
| TC-HOST-010 | Host配置管理 | 检查Host冲突API | P0 | 功能测试 | 用户已登录 |
| TC-HOST-011 | Host配置管理 | 排除自身配置的冲突检测 | P1 | 功能测试 | 用户已登录 |
| TC-PAC-001 | PAC配置生成 | 生成PAC配置 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-002 | PAC配置生成 | 只包含运行中的代理服务 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-003 | PAC配置生成 | 获取PAC文件 | P0 | 功能测试 | 无 |
| TC-PAC-004 | PAC配置生成 | PAC文件无需认证 | P0 | 功能测试 | 用户未登录 |
| TC-PAC-005 | PAC配置生成 | Host配置更新后PAC自动更新 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-006 | PAC配置生成 | 代理服务状态变化后PAC更新 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-007 | PAC配置生成 | 代理服务删除后PAC更新 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-008 | PAC配置生成 | PAC配置格式验证 | P0 | 功能测试 | 用户已登录 |
| TC-PAC-009 | PAC配置生成 | 代理地址格式验证 | P0 | 功能测试 | 用户已登录 |
| TC-SYS-001 | 系统配置 | 获取系统配置列表 | P1 | 功能测试 | 用户已登录 |
| TC-SYS-002 | 系统配置 | 获取register_enabled配置 | P1 | 功能测试 | 用户已登录 |
| TC-SYS-003 | 系统配置 | 获取不存在的配置 | P2 | 功能测试 | 用户已登录 |
| TC-SYS-004 | 系统配置 | 更新register_enabled配置 | P1 | 功能测试 | 用户已登录 |
| TC-SYS-005 | 系统配置 | 未登录时更新配置 | P1 | 功能测试 | 用户未登录 |
| TC-INT-001 | 集成测试 | 完整用户注册登录流程 | P0 | 集成测试 | 无 |
| TC-INT-002 | 集成测试 | 代理服务创建完整流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-003 | 集成测试 | Host配置更新触发PAC更新 | P0 | 集成测试 | 用户已登录 |
| TC-INT-004 | 集成测试 | 数据从前端到数据库的完整流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-005 | 集成测试 | 数据从数据库到前端的完整流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-006 | 集成测试 | Session认证完整流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-007 | 集成测试 | Session过期处理 | P0 | 集成测试 | 用户已登录 |
| TC-INT-008 | 集成测试 | SSH连接和密钥推送集成 | P0 | 集成测试 | 跳板服务器可访问 |
| TC-INT-009 | 集成测试 | SSH连接失败处理 | P0 | 集成测试 | 无 |
| TC-INT-010 | 集成测试 | 代理服务完整创建流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-011 | 集成测试 | 代理服务创建失败回滚 | P0 | 集成测试 | 用户已登录 |
| TC-INT-012 | 集成测试 | 代理服务启动流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-013 | 集成测试 | 代理服务停止流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-014 | 集成测试 | 代理服务状态监控 | P0 | 集成测试 | 用户已登录 |
| TC-INT-015 | 集成测试 | PAC配置生成完整流程 | P0 | 集成测试 | 用户已登录 |
| TC-INT-016 | 集成测试 | Host配置变化触发PAC更新 | P0 | 集成测试 | 用户已登录 |
| TC-INT-017 | 集成测试 | 代理服务状态变化触发PAC更新 | P0 | 集成测试 | 用户已登录 |
| TC-INT-018 | 集成测试 | 数据库CRUD操作 | P0 | 集成测试 | 无 |
| TC-INT-019 | 集成测试 | 数据库外键约束 | P0 | 集成测试 | 无 |
| TC-INT-020 | 集成测试 | 数据库唯一性约束 | P0 | 集成测试 | 无 |
| TC-INT-021 | 集成测试 | 代理服务和Host配置数据一致性 | P0 | 集成测试 | 用户已登录 |
| TC-INT-022 | 集成测试 | 代理服务状态一致性 | P0 | 集成测试 | 用户已登录 |
| TC-INT-023 | 集成测试 | 代理服务创建事务 | P0 | 集成测试 | 用户已登录 |
| TC-INT-024 | 集成测试 | 并发操作数据一致性 | P0 | 集成测试 | 用户已登录 |
| TC-PERF-001 | 性能测试 | 用户认证API响应时间 | P1 | 性能测试 | 无 |
| TC-PERF-002 | 性能测试 | 代理服务列表API响应时间 | P1 | 性能测试 | 数据已存在 |
| TC-PERF-003 | 性能测试 | 创建代理服务API响应时间 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-004 | 性能测试 | PAC配置生成API响应时间 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-005 | 性能测试 | 登录页面加载性能 | P2 | 性能测试 | 无 |
| TC-PERF-006 | 性能测试 | 主页面加载性能 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-007 | 性能测试 | 代理服务列表渲染性能 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-008 | 性能测试 | PAC配置预览加载性能 | P2 | 性能测试 | 用户已登录 |
| TC-PERF-009 | 性能测试 | 并发登录测试 | P1 | 性能测试 | 无 |
| TC-PERF-010 | 性能测试 | 并发创建代理服务测试 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-011 | 性能测试 | 并发查询测试 | P1 | 性能测试 | 用户已登录 |
| TC-PERF-012 | 性能测试 | 混合负载测试 | P1 | 性能测试 | 用户已登录 |
| TC-SEC-001 | 安全测试 | 密码存储加密验证 | P0 | 安全测试 | 无 |
| TC-SEC-002 | 安全测试 | 密码强度验证 | P0 | 安全测试 | 无 |
| TC-SEC-003 | 安全测试 | 密码传输安全 | P0 | 安全测试 | 无 |
| TC-SEC-004 | 安全测试 | Session Cookie安全属性 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-005 | 安全测试 | Session固定攻击防护 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-006 | 安全测试 | Session过期时间 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-007 | 安全测试 | Session劫持防护 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-008 | 安全测试 | 未认证访问受保护API | P0 | 安全测试 | 用户未登录 |
| TC-SEC-009 | 安全测试 | 伪造Session Cookie | P0 | 安全测试 | 无 |
| TC-SEC-010 | 安全测试 | SQL注入绕过认证 | P0 | 安全测试 | 无 |
| TC-SEC-011 | 安全测试 | 用户名格式验证 | P0 | 安全测试 | 无 |
| TC-SEC-012 | 安全测试 | 邮箱格式验证 | P0 | 安全测试 | 无 |
| TC-SEC-013 | 安全测试 | Host域名验证 | P0 | 安全测试 | 无 |
| TC-SEC-014 | 安全测试 | 跳板服务器地址验证 | P0 | 安全测试 | 无 |
| TC-SEC-015 | 安全测试 | 登录SQL注入测试 | P0 | 安全测试 | 无 |
| TC-SEC-016 | 安全测试 | 查询参数SQL注入测试 | P0 | 安全测试 | 无 |
| TC-SEC-017 | 安全测试 | 数据库操作SQL注入测试 | P0 | 安全测试 | 无 |
| TC-SEC-018 | 安全测试 | 存储型XSS测试 | P0 | 安全测试 | 无 |
| TC-SEC-019 | 安全测试 | 反射型XSS测试 | P0 | 安全测试 | 无 |
| TC-SEC-020 | 安全测试 | DOM型XSS测试 | P0 | 安全测试 | 无 |
| TC-SEC-021 | 安全测试 | Host配置XSS测试 | P0 | 安全测试 | 无 |
| TC-SEC-022 | 安全测试 | 未登录用户权限测试 | P0 | 安全测试 | 用户未登录 |
| TC-SEC-023 | 安全测试 | 已登录用户权限测试 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-024 | 安全测试 | Session失效后权限测试 | P0 | 安全测试 | 用户已登录 |
| TC-SEC-025 | 安全测试 | 跨用户数据访问测试 | P1 | 安全测试 | 多个用户已存在 |
| TC-UI-001 | UI/UX测试 | 三栏布局结构 | P1 | UI测试 | 用户已登录 |
| TC-UI-002 | UI/UX测试 | 顶部导航栏布局 | P1 | UI测试 | 无 |
| TC-UI-003 | UI/UX测试 | 左侧边栏布局 | P1 | UI测试 | 用户已登录 |
| TC-UI-004 | UI/UX测试 | 主内容区布局 | P1 | UI测试 | 用户已登录 |
| TC-UI-005 | UI/UX测试 | 代理配置卡片布局 | P1 | UI测试 | 用户已登录 |
| TC-UI-006 | UI/UX测试 | 标签页布局 | P1 | UI测试 | 用户已登录 |
| TC-UI-007 | UI/UX测试 | PAC配置预览区域布局 | P1 | UI测试 | 用户已登录 |
| TC-UI-008 | UI/UX测试 | 创建代理服务完整流程 | P0 | UI测试 | 用户已登录 |
| TC-UI-009 | UI/UX测试 | Host配置编辑流程 | P0 | UI测试 | 用户已登录 |
| TC-UI-010 | UI/UX测试 | 代理服务操作流程 | P0 | UI测试 | 用户已登录 |
| TC-UI-011 | UI/UX测试 | 代理服务创建表单交互 | P0 | UI测试 | 用户已登录 |
| TC-UI-012 | UI/UX测试 | Host配置表单交互 | P0 | UI测试 | 用户已登录 |
| TC-UI-013 | UI/UX测试 | 代理服务弹窗交互 | P1 | UI测试 | 用户已登录 |
| TC-UI-014 | UI/UX测试 | 日志窗口交互 | P1 | UI测试 | 用户已登录 |
| TC-UI-015 | UI/UX测试 | 标签页打开和关闭 | P0 | UI测试 | 用户已登录 |
| TC-UI-016 | UI/UX测试 | PAC配置预览标签页 | P1 | UI测试 | 用户已登录 |
| TC-UI-017 | UI/UX测试 | 桌面端布局（≥1200px） | P1 | UI测试 | 用户已登录 |
| TC-UI-018 | UI/UX测试 | 平板端布局（768px-1199px） | P2 | UI测试 | 用户已登录 |
| TC-UI-019 | UI/UX测试 | 移动端布局（<768px） | P2 | UI测试 | 用户已登录 |
| TC-UI-020 | UI/UX测试 | Chrome浏览器测试 | P1 | UI测试 | 无 |
| TC-UI-021 | UI/UX测试 | Firefox浏览器测试 | P1 | UI测试 | 无 |
| TC-UI-022 | UI/UX测试 | Safari浏览器测试 | P2 | UI测试 | 无 |
| TC-UI-023 | UI/UX测试 | Edge浏览器测试 | P2 | UI测试 | 无 |
| TC-BOUND-001 | 边界测试 | 用户名长度边界值 | P1 | 边界测试 | 无 |
| TC-BOUND-002 | 边界测试 | 密码长度边界值 | P1 | 边界测试 | 无 |
| TC-BOUND-003 | 边界测试 | 端口号边界值 | P0 | 边界测试 | 无 |
| TC-BOUND-004 | 边界测试 | Host列表边界值 | P1 | 边界测试 | 无 |
| TC-BOUND-005 | 边界测试 | 代理服务数量边界值 | P0 | 边界测试 | 用户已登录 |
| TC-BOUND-006 | 边界测试 | 分页边界值 | P1 | 边界测试 | 用户已登录 |
| TC-EXCEPT-001 | 异常测试 | 网络异常场景 | P0 | 异常测试 | 无 |
| TC-EXCEPT-002 | 异常测试 | 跳板服务器不可达 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-003 | 异常测试 | 跳板服务器SSH服务停止 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-004 | 异常测试 | autossh进程异常退出 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-005 | 异常测试 | 数据库文件损坏 | P0 | 异常测试 | 无 |
| TC-EXCEPT-006 | 异常测试 | 磁盘空间不足 | P1 | 异常测试 | 无 |
| TC-EXCEPT-007 | 异常测试 | 并发创建代理服务 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-008 | 异常测试 | 删除正在运行的代理服务 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-009 | 异常测试 | Session过期处理 | P0 | 异常测试 | 用户已登录 |
| TC-EXCEPT-010 | 异常测试 | 数据库连接失败 | P0 | 异常测试 | 无 |
| TC-ERROR-001 | 错误处理 | API错误响应格式 | P0 | 错误处理 | 无 |
| TC-ERROR-002 | 错误处理 | 前端错误提示 | P0 | 错误处理 | 无 |
| TC-ERROR-003 | 错误处理 | 表单验证错误提示 | P0 | 错误处理 | 无 |
| TC-ERROR-004 | 错误处理 | 网络错误处理 | P0 | 错误处理 | 无 |
| TC-ERROR-005 | 错误处理 | 服务器错误处理 | P0 | 错误处理 | 无 |
| TC-ERROR-006 | 错误处理 | 资源不存在错误 | P1 | 错误处理 | 无 |
| TC-ERROR-007 | 错误处理 | 权限不足错误 | P0 | 错误处理 | 无 |
| TC-ERROR-008 | 错误处理 | 资源冲突错误 | P0 | 错误处理 | 无 |
| TC-ERROR-009 | 错误处理 | 日志记录错误 | P1 | 错误处理 | 无 |
| TC-ERROR-010 | 错误处理 | 用户友好的错误信息 | P1 | 错误处理 | 无 |

**统计信息：**

- **总测试用例数**：150+
- **P0（高优先级）**：约80个
- **P1（中优先级）**：约50个
- **P2（低优先级）**：约20个

### 8.2 优先级分类

**优先级定义：**

- **P0（高优先级）**：核心功能测试，必须通过才能进入下一阶段
  - 用户认证功能
  - 代理服务管理核心功能
  - Host配置管理核心功能
  - PAC配置生成功能
  - 安全测试（认证、SQL注入、XSS）
  - 集成测试核心流程
  - 异常场景处理

- **P1（中优先级）**：重要功能测试，影响用户体验
  - 用户管理功能
  - 系统配置功能
  - 性能测试
  - UI布局测试
  - 边界值测试
  - 浏览器兼容性测试（Chrome、Firefox）

- **P2（低优先级）**：辅助功能测试，优化项
  - UI优化测试
  - 响应式设计测试（平板、移动端）
  - 浏览器兼容性测试（Safari、Edge）
  - 性能优化测试

**测试执行顺序建议：**

1. **第一阶段**：执行所有P0测试用例
2. **第二阶段**：执行所有P1测试用例
3. **第三阶段**：执行所有P2测试用例（如时间允许）

### 8.3 预期结果

**测试用例预期结果分类：**

1. **成功场景预期结果**
   - API返回200/201状态码
   - 响应体包含正确的数据
   - 数据库记录正确创建/更新/删除
   - 前端UI正确更新
   - 用户看到成功提示

2. **失败场景预期结果**
   - API返回适当的错误状态码（400/401/403/404/409/500）
   - 错误响应格式统一
   - 错误信息清晰易懂
   - 前端显示友好的错误提示
   - 系统状态保持一致（无数据损坏）

3. **性能场景预期结果**
   - API响应时间在指标范围内
   - 页面加载时间在指标范围内
   - 并发测试请求成功率>99%
   - 系统资源使用合理

4. **安全场景预期结果**
   - 密码加密存储
   - Session安全
   - SQL注入无效
   - XSS攻击无效
   - 权限控制正确

5. **UI场景预期结果**
   - 布局符合设计文档
   - 交互流畅
   - 响应式适配良好
   - 浏览器兼容

**测试结果记录格式：**

每个测试用例执行后应记录：

- **测试结果**：通过/失败/阻塞
- **实际结果**：详细描述实际执行结果
- **与预期结果对比**：说明差异
- **缺陷ID**：如果失败，关联缺陷ID
- **备注**：其他说明信息

**测试用例执行模板：**

```
测试用例编号：TC-XXX-XXX
测试用例名称：XXX功能测试
执行人：XXX
执行时间：YYYY-MM-DD HH:mm:ss
测试结果：通过/失败/阻塞
实际结果：
[详细描述实际执行结果]

与预期结果对比：
[说明与预期结果的差异]

缺陷ID：
[如果失败，填写关联的缺陷ID]

备注：
[其他说明信息]
```

---

## 九、测试执行计划

### 9.1 测试阶段划分

**阶段一：功能测试阶段（第1-2周）**

**目标**：验证所有功能模块的基本功能是否正常实现

**测试内容**：
- 用户认证模块测试（TC-AUTH-001 至 TC-AUTH-012）
- 用户管理模块测试（TC-USER-001 至 TC-USER-005）
- 代理服务管理模块测试（TC-PROXY-001 至 TC-PROXY-020）
- Host配置管理模块测试（TC-HOST-001 至 TC-HOST-011）
- PAC配置生成模块测试（TC-PAC-001 至 TC-PAC-009）
- 系统配置模块测试（TC-SYS-001 至 TC-SYS-005）

**交付物**：
- 功能测试报告
- 缺陷清单（P0级别）

**阶段二：集成测试阶段（第3周）**

**目标**：验证各模块之间的集成是否正常

**测试内容**：
- 前后端集成测试（TC-INT-001 至 TC-INT-007）
- 代理服务集成测试（TC-INT-008 至 TC-INT-017）
- 数据库集成测试（TC-INT-018 至 TC-INT-024）

**交付物**：
- 集成测试报告
- 缺陷清单（P0和P1级别）

**阶段三：安全测试阶段（第4周第1-2天）**

**目标**：验证系统安全性

**测试内容**：
- 认证安全测试（TC-SEC-001 至 TC-SEC-010）
- 输入验证测试（TC-SEC-011 至 TC-SEC-017）
- XSS防护测试（TC-SEC-018 至 TC-SEC-021）
- 权限控制测试（TC-SEC-022 至 TC-SEC-025）

**交付物**：
- 安全测试报告
- 安全漏洞清单

**阶段四：性能测试阶段（第4周第3-4天）**

**目标**：验证系统性能指标

**测试内容**：
- API响应时间测试（TC-PERF-001 至 TC-PERF-004）
- 页面加载性能测试（TC-PERF-005 至 TC-PERF-008）
- 并发测试（TC-PERF-009 至 TC-PERF-012）

**交付物**：
- 性能测试报告
- 性能优化建议

**阶段五：UI/UX测试阶段（第4周第5天）**

**目标**：验证用户界面和用户体验

**测试内容**：
- 界面布局测试（TC-UI-001 至 TC-UI-007）
- 交互功能测试（TC-UI-008 至 TC-UI-016）
- 响应式设计测试（TC-UI-017 至 TC-UI-019）
- 浏览器兼容性测试（TC-UI-020 至 TC-UI-023）

**交付物**：
- UI/UX测试报告
- UI优化建议

**阶段六：边界和异常测试阶段（第5周第1-2天）**

**目标**：验证边界值和异常场景处理

**测试内容**：
- 边界值测试（TC-BOUND-001 至 TC-BOUND-006）
- 异常场景测试（TC-EXCEPT-001 至 TC-EXCEPT-010）
- 错误处理测试（TC-ERROR-001 至 TC-ERROR-010）

**交付物**：
- 边界和异常测试报告
- 缺陷清单

**阶段七：回归测试阶段（第5周第3-5天）**

**目标**：验证缺陷修复后功能正常

**测试内容**：
- 重新执行所有P0测试用例
- 执行修复缺陷相关的测试用例
- 验证修复未引入新问题

**交付物**：
- 回归测试报告
- 最终测试总结报告

### 9.2 测试时间安排

**总体时间安排：5周**

| 阶段 | 时间 | 工作日 | 测试用例数（估算） | 备注 |
|------|------|--------|-------------------|------|
| 阶段一：功能测试 | 第1-2周 | 10天 | 60+ | 核心功能测试 |
| 阶段二：集成测试 | 第3周 | 5天 | 24 | 模块集成测试 |
| 阶段三：安全测试 | 第4周第1-2天 | 2天 | 25 | 安全漏洞检测 |
| 阶段四：性能测试 | 第4周第3-4天 | 2天 | 12 | 性能指标验证 |
| 阶段五：UI/UX测试 | 第4周第5天 | 1天 | 23 | 界面和交互测试 |
| 阶段六：边界和异常测试 | 第5周第1-2天 | 2天 | 26 | 边界和异常场景 |
| 阶段七：回归测试 | 第5周第3-5天 | 3天 | 80+ | 缺陷修复验证 |
| **总计** | **5周** | **25天** | **250+** | |

**每日测试时间安排建议：**

- **上午（9:00-12:00）**：执行测试用例，记录测试结果
- **下午（14:00-17:00）**：继续执行测试用例，编写缺陷报告
- **晚上（可选）**：整理测试报告，准备第二天测试数据

**里程碑时间点：**

- **第2周末**：功能测试完成，P0缺陷修复完成
- **第3周末**：集成测试完成，P0和P1缺陷修复完成
- **第4周末**：安全、性能、UI测试完成
- **第5周末**：所有测试完成，回归测试通过，准备进入Docker阶段

### 9.3 测试人员分工

**测试团队角色：**

1. **测试负责人**
   - 制定测试计划
   - 分配测试任务
   - 跟踪测试进度
   - 协调测试资源
   - 审核测试报告

2. **功能测试工程师（2人）**
   - 执行功能测试用例
   - 执行集成测试用例
   - 记录测试结果
   - 编写缺陷报告

3. **安全测试工程师（1人）**
   - 执行安全测试用例
   - 进行安全漏洞扫描
   - 编写安全测试报告
   - 提供安全修复建议

4. **性能测试工程师（1人）**
   - 执行性能测试用例
   - 分析性能数据
   - 编写性能测试报告
   - 提供性能优化建议

5. **UI/UX测试工程师（1人）**
   - 执行UI/UX测试用例
   - 验证界面设计符合规范
   - 编写UI/UX测试报告
   - 提供UI优化建议

**测试任务分配：**

| 测试模块 | 负责人 | 协助人员 | 预计时间 |
|---------|--------|---------|---------|
| 用户认证模块 | 功能测试工程师A | - | 1天 |
| 用户管理模块 | 功能测试工程师A | - | 0.5天 |
| 代理服务管理模块 | 功能测试工程师A | 功能测试工程师B | 3天 |
| Host配置管理模块 | 功能测试工程师B | - | 1.5天 |
| PAC配置生成模块 | 功能测试工程师B | - | 1天 |
| 系统配置模块 | 功能测试工程师B | - | 0.5天 |
| 前后端集成测试 | 功能测试工程师A | 功能测试工程师B | 2天 |
| 代理服务集成测试 | 功能测试工程师A | - | 2天 |
| 数据库集成测试 | 功能测试工程师B | - | 1天 |
| 安全测试 | 安全测试工程师 | - | 2天 |
| 性能测试 | 性能测试工程师 | - | 2天 |
| UI/UX测试 | UI/UX测试工程师 | - | 1天 |
| 边界和异常测试 | 功能测试工程师A | 功能测试工程师B | 2天 |
| 回归测试 | 全体测试人员 | - | 3天 |

**协作方式：**

- **每日站会**：每天上午9:00，15分钟，同步测试进度和问题
- **周会**：每周五下午，1小时，总结本周测试情况，规划下周工作
- **缺陷评审会**：发现P0缺陷时立即召开，确定修复优先级
- **测试报告评审**：每个阶段结束后，评审测试报告

### 9.4 缺陷管理流程

**缺陷分类：**

1. **按严重程度分类**
   - **P0（严重）**：系统无法使用，核心功能完全失效
     - 示例：无法登录、无法创建代理服务、数据丢失
   - **P1（重要）**：重要功能失效，影响主要业务流程
     - 示例：代理服务无法启动、Host配置无法保存
   - **P2（一般）**：一般功能问题，影响次要功能
     - 示例：UI显示异常、错误提示不清晰
   - **P3（轻微）**：界面优化、体验问题
     - 示例：按钮位置不理想、颜色搭配问题

2. **按缺陷类型分类**
   - **功能缺陷**：功能不符合需求或设计
   - **性能缺陷**：性能不满足要求
   - **安全缺陷**：存在安全漏洞
   - **UI缺陷**：界面显示或交互问题
   - **兼容性缺陷**：浏览器兼容性问题

**缺陷处理流程：**

1. **缺陷发现**
   - 测试人员执行测试用例时发现缺陷
   - 记录缺陷信息（标题、描述、复现步骤、预期结果、实际结果、截图等）
   - 提交缺陷报告到缺陷管理系统

2. **缺陷确认**
   - 测试负责人确认缺陷有效性
   - 分配缺陷给开发人员
   - 设置缺陷优先级和严重程度

3. **缺陷修复**
   - 开发人员修复缺陷
   - 提交代码修复
   - 标记缺陷为"已修复"

4. **缺陷验证**
   - 测试人员验证缺陷是否修复
   - 执行相关测试用例
   - 确认修复后关闭缺陷
   - 如果未修复，重新打开缺陷

5. **缺陷关闭**
   - 缺陷修复验证通过后关闭
   - 记录关闭时间和验证人

**缺陷报告模板：**

```
缺陷ID：BUG-XXX
缺陷标题：[简要描述缺陷]
发现时间：YYYY-MM-DD HH:mm:ss
发现人：XXX
所属模块：XXX模块
严重程度：P0/P1/P2/P3
缺陷类型：功能缺陷/性能缺陷/安全缺陷/UI缺陷/兼容性缺陷
测试用例编号：TC-XXX-XXX

缺陷描述：
[详细描述缺陷现象]

复现步骤：
1. [步骤1]
2. [步骤2]
3. [步骤3]

预期结果：
[描述预期结果]

实际结果：
[描述实际结果]

环境信息：
- 操作系统：XXX
- 浏览器：XXX版本
- Node.js版本：XXX
- 数据库：SQLite XXX

附件：
[截图、日志文件等]

关联测试用例：
TC-XXX-XXX
```

**缺陷统计和跟踪：**

- **每日缺陷统计**：统计每日发现、修复、关闭的缺陷数量
- **缺陷趋势分析**：分析缺陷发现趋势，评估测试进度
- **缺陷分布分析**：分析缺陷在各模块的分布，识别问题模块
- **缺陷修复率**：跟踪缺陷修复进度，确保P0缺陷及时修复

**缺陷管理工具：**

- **推荐工具**：Jira、GitHub Issues、Trello、Excel表格
- **工具选择**：根据团队规模和习惯选择合适工具
- **工具要求**：支持缺陷分类、优先级设置、状态跟踪、统计报表

**缺陷修复标准：**

- **P0缺陷**：必须在24小时内修复
- **P1缺陷**：必须在3个工作日内修复
- **P2缺陷**：必须在1周内修复
- **P3缺陷**：可以在下一版本修复

**测试完成标准：**

- 所有P0测试用例通过率100%
- 所有P1测试用例通过率≥95%
- P0缺陷修复率100%
- P1缺陷修复率≥90%
- 性能指标满足要求
- 安全测试无高危漏洞
- 回归测试通过

**测试报告模板：**

每个测试阶段结束后应生成测试报告，包含：

1. **测试概述**
   - 测试阶段名称
   - 测试时间范围
   - 测试人员
   - 测试环境

2. **测试执行情况**
   - 测试用例总数
   - 执行用例数
   - 通过用例数
   - 失败用例数
   - 阻塞用例数
   - 通过率

3. **缺陷统计**
   - 发现缺陷总数
   - 按严重程度分类统计
   - 按模块分类统计
   - 修复缺陷数
   - 未修复缺陷数

4. **测试结论**
   - 测试是否通过
   - 是否可以进入下一阶段
   - 风险提示

5. **附录**
   - 缺陷清单
   - 测试用例执行记录
   - 测试数据

---

## 附录

### A. 测试工具清单

**API测试工具：**

1. **Postman**
   - 用途：API接口测试
   - 下载地址：https://www.postman.com/downloads/
   - 使用场景：功能测试、集成测试

2. **curl**
   - 用途：命令行HTTP客户端
   - 安装：系统自带或`apt-get install curl` / `brew install curl`
   - 使用场景：快速API测试、脚本自动化

3. **HTTPie**
   - 用途：友好的命令行HTTP客户端
   - 安装：`pip install httpie`
   - 使用场景：命令行API测试

**性能测试工具：**

1. **Apache Bench (ab)**
   - 用途：HTTP性能测试
   - 安装：`apt-get install apache2-utils` / `brew install httpd`
   - 使用场景：API性能测试、并发测试

2. **k6**
   - 用途：负载测试
   - 安装：`brew install k6` 或参考 https://k6.io/docs/getting-started/installation/
   - 使用场景：复杂场景的性能测试

3. **Artillery**
   - 用途：负载测试
   - 安装：`npm install -g artillery`
   - 使用场景：API负载测试

**前端测试工具：**

1. **Chrome DevTools**
   - 用途：页面调试、性能分析、网络监控
   - 使用方法：F12打开开发者工具
   - 使用场景：UI测试、性能测试

2. **Vue DevTools**
   - 用途：Vue组件调试
   - 安装：Chrome扩展商店
   - 使用场景：前端调试

3. **Lighthouse**
   - 用途：页面性能分析
   - 使用方法：Chrome DevTools Lighthouse标签页
   - 使用场景：性能测试

**安全测试工具：**

1. **OWASP ZAP**
   - 用途：自动化安全扫描
   - 下载地址：https://www.zaproxy.org/download/
   - 使用场景：安全漏洞扫描

2. **Burp Suite**
   - 用途：Web应用安全测试
   - 下载地址：https://portswigger.net/burp
   - 使用场景：安全测试、渗透测试

**数据库管理工具：**

1. **DB Browser for SQLite**
   - 用途：SQLite数据库可视化管理
   - 下载地址：https://sqlitebrowser.org/
   - 使用场景：数据库测试、数据验证

2. **命令行sqlite3**
   - 用途：快速数据库操作
   - 安装：系统自带或`apt-get install sqlite3`
   - 使用场景：数据库操作测试

**代码质量工具：**

1. **ESLint**
   - 用途：JavaScript代码检查
   - 安装：`npm install -g eslint`
   - 使用场景：代码质量检查

2. **Prettier**
   - 用途：代码格式化
   - 安装：`npm install -g prettier`
   - 使用场景：代码格式化

### B. 测试数据模板

**测试用户数据模板：**

```json
{
  "users": [
    {
      "username": "testuser1",
      "password": "Test123456",
      "email": "testuser1@example.com",
      "description": "基础功能测试用户"
    },
    {
      "username": "testuser2",
      "password": "Test123456",
      "email": "testuser2@example.com",
      "description": "并发测试用户"
    },
    {
      "username": "admin",
      "password": "Admin123456",
      "email": "admin@example.com",
      "description": "管理员测试用户"
    }
  ]
}
```

**测试跳板服务器数据模板：**

```json
{
  "jump_servers": [
    {
      "name": "测试跳板1",
      "host": "43.163.237.183",
      "port": 22,
      "username": "larrin",
      "password": "TheDog@01",
      "description": "代理服务测试用跳板服务器"
    },
    {
      "name": "测试跳板2",
      "host": "43.153.100.84",
      "port": 22,
      "username": "larrin",
      "password": "TheDog@01",
      "description": "多代理服务测试用跳板服务器"
    }
  ]
}
```

**测试Host数据模板：**

```json
{
  "hosts": [
    "google.com",
    "youtube.com",
    "facebook.com",
    "twitter.com",
    "instagram.com",
    "chatgpt.com",
    "github.com",
    "stackoverflow.com",
    "reddit.com",
    "linkedin.com"
  ]
}
```

**测试代理服务配置模板：**

```json
{
  "proxy_service": {
    "name": "测试代理服务1",
    "jump_host": "43.163.237.183",
    "jump_port": 22,
    "jump_username": "larrin",
    "password": "TheDog@01",
    "hosts": [
      "google.com",
      "youtube.com",
      "chatgpt.com"
    ]
  }
}
```

**测试API请求模板：**

**登录请求：**
```json
{
  "username": "testuser1",
  "password": "Test123456"
}
```

**创建代理服务请求：**
```json
{
  "name": "测试代理服务",
  "jump_host": "43.163.237.183",
  "jump_port": 22,
  "jump_username": "larrin",
  "password": "TheDog@01",
  "hosts": ["google.com", "youtube.com"]
}
```

**创建Host配置请求：**
```json
{
  "name": "测试配置",
  "proxy_service_id": 1,
  "hosts": ["facebook.com", "twitter.com"]
}
```

### C. 缺陷报告模板

**缺陷报告标准模板：**

```markdown
# 缺陷报告

## 基本信息
- **缺陷ID**：BUG-XXX
- **缺陷标题**：[简要描述缺陷，如：创建代理服务时SSH连接失败未正确提示]
- **发现时间**：YYYY-MM-DD HH:mm:ss
- **发现人**：XXX
- **所属模块**：代理服务管理模块
- **严重程度**：P0/P1/P2/P3
- **缺陷类型**：功能缺陷/性能缺陷/安全缺陷/UI缺陷/兼容性缺陷
- **测试用例编号**：TC-PROXY-002

## 缺陷描述
[详细描述缺陷现象，包括：
- 缺陷的具体表现
- 影响范围
- 用户影响]

## 复现步骤
1. [步骤1：如：访问代理服务管理页面]
2. [步骤2：如：点击"添加新配置"按钮]
3. [步骤3：如：填写跳板服务器信息，使用错误的地址]
4. [步骤4：如：点击创建按钮]
5. [步骤5：如：观察错误提示]

## 预期结果
[描述预期结果，如：
- 应显示清晰的错误提示："无法连接到跳板服务器，请检查网络和地址"
- 错误信息应帮助用户定位问题]

## 实际结果
[描述实际结果，如：
- 显示通用错误信息："操作失败"
- 错误信息不清晰，用户无法定位问题]

## 环境信息
- **操作系统**：Ubuntu 20.04
- **浏览器**：Chrome 120.0
- **Node.js版本**：18.17.0
- **数据库**：SQLite 3.31.1
- **测试环境**：本地开发环境

## 截图/日志
[如有截图、日志文件，在此处引用或附加]

## 关联信息
- **关联测试用例**：TC-PROXY-002
- **关联需求**：需求文档第X章第X节
- **关联设计**：详细方案设计文档第X章第X节

## 处理信息
- **分配给**：开发人员XXX
- **修复时间**：YYYY-MM-DD HH:mm:ss
- **修复人**：XXX
- **验证时间**：YYYY-MM-DD HH:mm:ss
- **验证人**：XXX
- **状态**：新建/已分配/修复中/已修复/已验证/已关闭
```

**缺陷报告简化模板（快速记录）：**

```
缺陷ID：BUG-XXX
标题：[简要描述]
模块：XXX
严重程度：P0/P1/P2/P3
复现步骤：
1. XXX
2. XXX
3. XXX
预期结果：XXX
实际结果：XXX
环境：XXX
```

### D. 测试用例执行记录模板

**测试用例执行记录表：**

| 用例编号 | 用例名称 | 执行人 | 执行时间 | 测试结果 | 实际结果 | 缺陷ID | 备注 |
|---------|---------|--------|---------|---------|---------|--------|------|
| TC-AUTH-001 | 正常注册流程 | XXX | YYYY-MM-DD | 通过 | [描述] | - | - |
| TC-AUTH-002 | 用户名已存在 | XXX | YYYY-MM-DD | 失败 | [描述] | BUG-001 | - |

**测试用例执行记录详细模板：**

```markdown
# 测试用例执行记录

## 测试用例信息
- **用例编号**：TC-XXX-XXX
- **用例名称**：XXX功能测试
- **所属模块**：XXX模块
- **优先级**：P0/P1/P2
- **测试类型**：功能测试/集成测试/性能测试/安全测试/UI测试

## 执行信息
- **执行人**：XXX
- **执行时间**：YYYY-MM-DD HH:mm:ss
- **执行环境**：本地开发环境
- **前置条件**：[描述前置条件]

## 执行步骤
1. [步骤1]
2. [步骤2]
3. [步骤3]

## 执行结果
- **测试结果**：通过/失败/阻塞
- **实际结果**：[详细描述实际执行结果]
- **与预期结果对比**：[说明差异]
- **执行耗时**：XXX秒

## 缺陷信息
- **是否发现缺陷**：是/否
- **缺陷ID**：BUG-XXX（如有）
- **缺陷描述**：[简要描述]

## 备注
[其他说明信息]
```

### E. 测试报告模板

**测试阶段报告模板：**

```markdown
# [测试阶段名称]测试报告

## 1. 测试概述
- **测试阶段**：功能测试阶段
- **测试时间**：YYYY-MM-DD 至 YYYY-MM-DD
- **测试人员**：XXX、XXX
- **测试环境**：本地开发环境

## 2. 测试执行情况
- **测试用例总数**：XXX
- **执行用例数**：XXX
- **通过用例数**：XXX
- **失败用例数**：XXX
- **阻塞用例数**：XXX
- **通过率**：XX%

## 3. 缺陷统计
- **发现缺陷总数**：XXX
- **P0缺陷数**：XXX（已修复：XXX）
- **P1缺陷数**：XXX（已修复：XXX）
- **P2缺陷数**：XXX（已修复：XXX）
- **P3缺陷数**：XXX（已修复：XXX）

## 4. 缺陷分布
- **用户认证模块**：XXX个
- **代理服务管理模块**：XXX个
- **Host配置管理模块**：XXX个
- **其他模块**：XXX个

## 5. 测试结论
- **测试是否通过**：是/否
- **是否可以进入下一阶段**：是/否
- **风险提示**：[如有风险，在此说明]

## 6. 附录
- 缺陷清单（见附件）
- 测试用例执行记录（见附件）
```

---

**文档版本**：1.0  
**创建日期**：2024年  
**最后更新**：2024年  
**维护者**：测试团队
